<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incident Response Fundamentals Quiz | AWS Security Specialty (SCS-C03)</title>
    <style>
        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #141b2d;
            --bg-tertiary: #1a2236;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --accent-primary: #ef4444;
            --accent-secondary: #f87171;
            --success: #22c55e;
            --error: #ef4444;
            --warning: #eab308;
            --info: #3b82f6;
            --border: #2d3a52;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg-primary); color: var(--text-primary); line-height: 1.6; min-height: 100vh; }
        .container { max-width: 900px; margin: 0 auto; padding: 2rem; }
        header { text-align: center; margin-bottom: 2rem; padding: 2rem; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%); border-radius: 16px; border: 1px solid var(--border); }
        .badge { display: inline-block; background: var(--accent-primary); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; margin-bottom: 1rem; text-transform: uppercase; }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .subtitle { color: var(--text-secondary); font-size: 1rem; }
        .stats-bar { display: flex; justify-content: center; gap: 2rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border); }
        .stat { text-align: center; }
        .stat-value { font-size: 1.5rem; font-weight: 700; color: var(--accent-primary); }
        .stat-label { font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; }
        .mode-selector { display: flex; gap: 1rem; justify-content: center; margin-bottom: 2rem; }
        .mode-btn { padding: 0.75rem 2rem; border: 2px solid var(--border); background: var(--bg-secondary); color: var(--text-primary); border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease; }
        .mode-btn:hover { border-color: var(--accent-primary); background: var(--bg-tertiary); }
        .progress-container { background: var(--bg-secondary); border-radius: 12px; padding: 1rem 1.5rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
        .progress-text { font-size: 0.875rem; color: var(--text-secondary); }
        .timer { font-size: 1.25rem; font-weight: 600; color: var(--accent-primary); font-family: 'Consolas', monospace; }
        .timer.warning { color: var(--warning); animation: pulse 1s infinite; }
        .timer.danger { color: var(--error); animation: pulse 0.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .progress-bar { height: 8px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary)); border-radius: 4px; transition: width 0.3s ease; }
        .question-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .question-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
        .question-number { background: var(--bg-tertiary); color: var(--accent-primary); padding: 0.25rem 0.75rem; border-radius: 6px; font-size: 0.875rem; font-weight: 600; }
        .question-domain { font-size: 0.75rem; color: var(--text-secondary); background: var(--bg-tertiary); padding: 0.25rem 0.5rem; border-radius: 4px; }
        .question-text { font-size: 1.125rem; margin-bottom: 1.5rem; line-height: 1.7; }
        .options { display: flex; flex-direction: column; gap: 0.75rem; }
        .option { display: flex; align-items: flex-start; gap: 1rem; padding: 1rem; background: var(--bg-tertiary); border: 2px solid var(--border); border-radius: 10px; cursor: pointer; transition: all 0.2s ease; }
        .option:hover:not(.disabled) { border-color: var(--accent-primary); background: rgba(239, 68, 68, 0.1); }
        .option.selected { border-color: var(--accent-primary); border-width: 3px; background: rgba(239, 68, 68, 0.2); box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.25), inset 0 0 12px rgba(239, 68, 68, 0.1); }
        .option.correct { border-color: var(--success); background: rgba(34, 197, 94, 0.15); }
        .option.incorrect { border-color: var(--error); background: rgba(239, 68, 68, 0.15); }
        .option.disabled { cursor: default; }
        .option-marker { width: 28px; height: 28px; border-radius: 50%; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; flex-shrink: 0; transition: all 0.2s ease; }
        .option.selected .option-marker { border-color: var(--accent-primary); background: var(--accent-primary); color: white; }
        .option.correct .option-marker { border-color: var(--success); background: var(--success); color: white; }
        .option.incorrect .option-marker { border-color: var(--error); background: var(--error); color: white; }
        .option-text { flex: 1; padding-top: 2px; }
        .explanation { margin-top: 1.5rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; border-left: 4px solid var(--info); display: none; }
        .explanation.show { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .explanation-title { display: flex; align-items: center; gap: 0.5rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--info); }
        .answer-header { font-weight: 600; color: var(--success); margin-bottom: 0.5rem; }
        .explanation-text { color: var(--text-secondary); margin-bottom: 1rem; }
        .doc-link { display: inline-flex; align-items: center; gap: 0.5rem; color: var(--accent-primary); text-decoration: none; font-size: 0.875rem; padding: 0.5rem 1rem; background: rgba(239, 68, 68, 0.1); border-radius: 6px; transition: background 0.2s ease; }
        .doc-link:hover { background: rgba(239, 68, 68, 0.2); }
        .btn-container { display: flex; justify-content: space-between; gap: 1rem; margin-top: 1rem; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
        .btn-primary { background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4); }
        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); }
        .btn-secondary:hover { border-color: var(--accent-primary); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .results-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; text-align: center; border: 1px solid var(--border); display: none; }
        .results-card.show { display: block; animation: fadeIn 0.5s ease; }
        .results-score { font-size: 4rem; font-weight: 700; margin: 1rem 0; }
        .results-score.pass { color: var(--success); }
        .results-score.fail { color: var(--error); }
        .results-status { font-size: 1.5rem; margin-bottom: 1rem; }
        .results-status.pass { color: var(--success); }
        .results-status.fail { color: var(--error); }
        .results-details { color: var(--text-secondary); margin-bottom: 2rem; }
        .results-breakdown { display: flex; justify-content: center; gap: 3rem; margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; }
        .breakdown-item { text-align: center; }
        .breakdown-value { font-size: 2rem; font-weight: 700; }
        .breakdown-value.correct { color: var(--success); }
        .breakdown-value.incorrect { color: var(--error); }
        .breakdown-label { font-size: 0.875rem; color: var(--text-secondary); }
        .hidden { display: none !important; }
        .shuffle-notice { text-align: center; padding: 0.75rem; background: rgba(239, 68, 68, 0.1); border-radius: 8px; margin-bottom: 1.5rem; color: var(--accent-secondary); font-size: 0.875rem; }
        .btn-group { display: flex; gap: 1rem; justify-content: center; margin-top: 1rem; }
        .review-section { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; border: 1px solid var(--border); display: none; }
        .review-section.show { display: block; animation: fadeIn 0.5s ease; }
        .review-header { text-align: center; margin-bottom: 2rem; }
        .review-hint { text-align: center; color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 1rem; }
        .review-table { width: 100%; border-collapse: collapse; margin-bottom: 2rem; }
        .review-table th { background: var(--bg-tertiary); color: var(--text-secondary); font-size: 0.875rem; font-weight: 600; text-transform: uppercase; padding: 1rem; text-align: left; border-bottom: 2px solid var(--border); }
        .review-table td { padding: 1rem; border-bottom: 1px solid var(--border); vertical-align: top; }
        .review-table tbody tr { cursor: pointer; transition: all 0.2s ease; }
        .review-table tbody tr:hover { background: rgba(239, 68, 68, 0.1); transform: translateX(4px); }
        .review-table tbody tr.reviewed { background: rgba(239, 68, 68, 0.25); border-left: 6px solid var(--accent-primary); box-shadow: inset 0 0 20px rgba(239, 68, 68, 0.15); }
        .review-table tbody tr.reviewed:hover { background: rgba(239, 68, 68, 0.3); }
        .review-table tbody tr.reviewed .review-q-num { color: var(--accent-secondary); font-weight: 800; }
        .review-table tbody tr.reviewed .review-q-num::before { content: "‚úì "; color: var(--accent-primary); font-size: 1rem; }
        .review-q-num { font-weight: 700; color: var(--accent-primary); white-space: nowrap; }
        .review-q-text { color: var(--text-primary); line-height: 1.6; }
        .review-answer { font-weight: 600; }
        .review-answer.correct { color: var(--success); }
        .review-answer.incorrect { color: var(--error); }
        .review-status { text-align: center; font-size: 1.25rem; }
        @media (max-width: 640px) { .container { padding: 1rem; } h1 { font-size: 1.5rem; } .stats-bar { gap: 1rem; } .mode-selector { flex-direction: column; } .btn-container { flex-direction: column; } .results-breakdown { flex-direction: column; gap: 1.5rem; } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <span class="badge">Domain 2: Incident Response</span>
            <h1>üö® Incident Response Fundamentals</h1>
            <p class="subtitle">Comprehensive Quiz for AWS Security Specialty (SCS-C03)</p>
            <div class="stats-bar">
                <div class="stat"><div class="stat-value">25</div><div class="stat-label">Questions</div></div>
                <div class="stat"><div class="stat-value">80%</div><div class="stat-label">Pass Score</div></div>
                <div class="stat"><div class="stat-value">62:30</div><div class="stat-label">Exam Time</div></div>
            </div>
        </header>
        <div class="mode-selector" id="modeSelector">
            <button class="mode-btn" onclick="startQuiz('learn')">üìö Learn Mode</button>
            <button class="mode-btn" onclick="startQuiz('exam')">‚è±Ô∏è Exam Mode</button>
        </div>
        <div id="quizContent" class="hidden">
            <div class="progress-container">
                <div class="progress-header">
                    <span class="progress-text">Question <span id="currentQ">1</span> of <span id="totalQ">25</span></span>
                    <span class="timer" id="timer">62:30</span>
                </div>
                <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width: 0%"></div></div>
            </div>
            <div class="shuffle-notice" id="shuffleNotice">üîÄ Questions and options have been randomized</div>
            <div id="questionsContainer"></div>
            <div class="btn-container">
                <button class="btn btn-secondary" id="backToReviewBtn" onclick="backToReview()" style="display: none;">‚Üê Back to Review</button>
                <button class="btn btn-secondary" id="prevBtn" onclick="navigate(-1)" disabled>‚Üê Previous</button>
                <button class="btn btn-secondary" id="shuffleBtn" onclick="shuffleQuiz()">üîÄ Shuffle</button>
                <button class="btn btn-primary" id="nextBtn" onclick="navigate(1)">Next ‚Üí</button>
            </div>
        </div>
        <div class="results-card" id="resultsCard">
            <h2>Quiz Complete!</h2>
            <div class="results-score" id="scorePercent">0%</div>
            <div class="results-status" id="resultStatus">-</div>
            <p class="results-details" id="resultDetails"></p>
            <div class="results-breakdown">
                <div class="breakdown-item"><div class="breakdown-value correct" id="correctCount">0</div><div class="breakdown-label">Correct</div></div>
                <div class="breakdown-item"><div class="breakdown-value incorrect" id="incorrectCount">0</div><div class="breakdown-label">Incorrect</div></div>
            </div>
            <div class="btn-group" id="resultsButtons">
                <button class="btn btn-primary" id="reviewBtn" onclick="showReview()" style="display: none;">üìä Review Answers</button>
                <button class="btn btn-secondary" onclick="restartQuiz()">üîÑ Restart Quiz</button>
            </div>
        </div>

        <div class="review-section" id="reviewSection">
            <div class="review-header">
                <h2>Answer Review</h2>
                <p class="results-details">Click any question to review the full answer and explanation</p>
            </div>
            <p class="review-hint">üí° Tip: Click on any row to see the full question and explanation in Learn mode</p>
            <table class="review-table">
                <thead>
                    <tr>
                        <th style="width: 5%">#</th>
                        <th style="width: 50%">Question</th>
                        <th style="width: 15%">Your Answer</th>
                        <th style="width: 15%">Correct Answer</th>
                        <th style="width: 10%">Status</th>
                    </tr>
                </thead>
                <tbody id="reviewTableBody"></tbody>
            </table>
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="backToResults()">‚Üê Back to Results</button>
                <button class="btn btn-primary" onclick="restartQuiz()">üîÑ Restart Quiz</button>
            </div>
        </div>
    </div>
    <script>
        const questions = [
            {
                id: 1,
                question: "According to NIST 800-61, what are the four main phases of the incident response lifecycle?",
                options: [
                    "Detection, Analysis, Containment, Recovery",
                    "Preparation, Detection & Analysis, Containment/Eradication/Recovery, Post-Incident Activity",
                    "Planning, Execution, Monitoring, Improvement",
                    "Identify, Protect, Detect, Respond"
                ],
                correct: 1,
                explanation: "NIST 800-61 defines four phases: Preparation (getting ready before incidents), Detection & Analysis (identifying and understanding incidents), Containment/Eradication/Recovery (stopping, removing, and recovering from incidents), and Post-Incident Activity (learning and improving). AWS Security Incident Response aligns with this framework.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/aws-security-incident-response-guide.html"
            },
            {
                id: 2,
                question: "What is 'destination containment' in AWS incident response?",
                options: [
                    "Blocking traffic at the source using AWS WAF rules and IP deny lists",
                    "Applying filtering or routing to prevent access to a targeted host or resource",
                    "Revoking IAM credentials associated with the compromised destination resource",
                    "Creating forensic snapshots of the destination system before isolation"
                ],
                correct: 1,
                explanation: "Destination containment is applying filtering or routing within an environment to prevent access to a targeted host or resource. Examples include applying Network ACLs to block traffic, using isolation VPCs, detaching resources from Auto Scaling groups, and deregistering from load balancers.",
                docLink: "https://docs.aws.amazon.com/security-ir/latest/userguide/destination-containment.html"
            },
            {
                id: 3,
                question: "Which AWS service provides a managed incident response capability with 24/7 security experts?",
                options: [
                    "Amazon GuardDuty",
                    "AWS Security Hub",
                    "AWS Security Incident Response",
                    "Amazon Detective"
                ],
                correct: 2,
                explanation: "AWS Security Incident Response is a managed service that provides 24/7 access to AWS security experts who help you prepare for, respond to, and recover from security events. It includes a self-service portal for case management and aligns with NIST 800-61.",
                docLink: "https://docs.aws.amazon.com/security-ir/latest/userguide/concepts-and-terminology.html"
            },
            {
                id: 4,
                question: "What is the first action you should take when you suspect an EC2 instance is compromised?",
                options: [
                    "Immediately terminate the instance to stop the attacker and prevent lateral movement",
                    "Capture metadata and isolate the instance while preserving forensic evidence",
                    "Analyze CloudTrail logs to understand the scope before taking containment actions",
                    "Rotate the IAM role credentials attached to the instance to prevent API abuse"
                ],
                correct: 1,
                explanation: "When responding to a potentially compromised EC2 instance, first capture metadata (instance ID, security groups, IAM role, etc.) and then isolate the instance while preserving evidence. This typically involves changing security groups to restrict traffic, taking EBS snapshots, and capturing memory if needed.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/operations.html"
            },
            {
                id: 5,
                question: "What is the purpose of an 'isolation VPC' in incident response?",
                options: [
                    "A VPC with no internet gateway used to completely air-gap compromised instances",
                    "A pre-configured VPC to contain compromised resources while allowing legitimate AV/EDR traffic",
                    "A forensics VPC where EBS snapshots are restored for offline analysis",
                    "A staging VPC where instances are scanned before returning to production"
                ],
                correct: 1,
                explanation: "An isolation VPC is a pre-configured VPC that provides effective containment of potentially compromised resources while still allowing legitimate traffic (like antivirus or EDR solutions that need internet access). Resources are moved to this isolation VPC during active security events.",
                docLink: "https://docs.aws.amazon.com/security-ir/latest/userguide/destination-containment.html"
            },
            {
                id: 6,
                question: "How should you capture forensic evidence from an EC2 instance's EBS volume?",
                options: [
                    "Use SSM Run Command to archive log files and upload them to an S3 bucket",
                    "Create an EBS snapshot immediately to preserve the complete disk state for analysis",
                    "Stop the instance and copy the volume to a forensics account using EBS copy",
                    "Create an AMI of the instance which captures both disk and memory state"
                ],
                correct: 1,
                explanation: "Create EBS snapshots immediately to preserve the disk state for forensic analysis. Snapshots capture the entire volume at a point in time. You can then create new volumes from these snapshots in an isolated forensics environment for investigation without affecting the original evidence.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/operations.html"
            },
            {
                id: 7,
                question: "What is 'source containment' in AWS incident response?",
                options: [
                    "Blocking the source of an attack from reaching AWS resources via IP blocks or credential revocation",
                    "Isolating the compromised destination resource from the rest of the network",
                    "Preserving the original evidence source before any forensic analysis begins",
                    "Identifying the origin of malicious traffic using VPC Flow Logs and CloudTrail"
                ],
                correct: 0,
                explanation: "Source containment focuses on blocking the source of an attack from reaching AWS resources. This can include blocking IP addresses using security groups, NACLs, or AWS WAF; disabling compromised IAM credentials; or blocking specific users or roles that may be compromised.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/source-containment.html"
            },
            {
                id: 8,
                question: "What is the AWS Shared Responsibility Model's implication for incident response?",
                options: [
                    "AWS handles all incident response activities",
                    "Customers handle all incident response activities",
                    "AWS secures the cloud infrastructure; customers are responsible for security in the cloud",
                    "Responsibility depends on the support plan tier"
                ],
                correct: 2,
                explanation: "Under the Shared Responsibility Model, AWS manages security OF the cloud (physical infrastructure, hypervisor, etc.), while customers are responsible for security IN the cloud (OS, applications, data, access management, etc.). For incident response, customers must prepare for and respond to incidents in their resources.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/introduction.html"
            },
            {
                id: 9,
                question: "What should be included in an incident response preparation plan?",
                options: [
                    "Technical runbooks focused on automated remediation using Lambda and Step Functions",
                    "Contact lists, escalation procedures, runbooks, pre-provisioned access, and required tools",
                    "AWS account inventory with IAM policies and security group configurations documented",
                    "Network architecture diagrams showing VPC peering and Transit Gateway connections"
                ],
                correct: 1,
                explanation: "Preparation should include: contact lists and escalation procedures, incident response runbooks, pre-provisioned access and tools, documented account and resource inventory, established relationships with AWS Support (if applicable), and regular testing through tabletop exercises and game days.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/preparation.html"
            },
            {
                id: 10,
                question: "How can you quickly isolate a potentially compromised EC2 instance from the network?",
                options: [
                    "Terminate the instance to immediately stop all network activity and prevent further damage",
                    "Replace its security groups with a quarantine group that denies all inbound and outbound traffic",
                    "Modify the NACL associated with the subnet to block all traffic to the instance IP",
                    "Detach the IAM role to prevent the instance from making any AWS API calls"
                ],
                correct: 1,
                explanation: "The fastest way to network-isolate an EC2 instance is to replace its security groups with a 'quarantine' security group that has no inbound or outbound rules (denies all traffic by default). This preserves the instance for forensics while preventing further network communication.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/operations.html"
            },
            {
                id: 11,
                question: "What is the purpose of 'containment action preferences' in AWS Security Incident Response?",
                options: [
                    "Configuration settings that define which AWS services are in scope for incident monitoring",
                    "Pre-authorized rapid response measures like isolating hosts and rotating credentials",
                    "Policies that specify which team members can access incident case information",
                    "Thresholds that trigger automatic escalation when security metrics exceed limits"
                ],
                correct: 1,
                explanation: "Containment action preferences allow you to pre-authorize rapid response measures that the AWS Security Incident Response team can take during an active security event. This includes isolating compromised hosts, rotating credentials, and other containment actions to speed up response time.",
                docLink: "https://docs.aws.amazon.com/security-ir/latest/userguide/define-containment-preferences.html"
            },
            {
                id: 12,
                question: "What is 'triage' in the context of incident response?",
                options: [
                    "The comprehensive post-incident report documenting root cause and lessons learned",
                    "The initial assessment and prioritization of a security event to determine response",
                    "The process of removing malware and closing vulnerabilities during eradication",
                    "The validation step confirming systems are clean before returning to production"
                ],
                correct: 1,
                explanation: "Triage is the initial assessment and prioritization of a security event to determine the appropriate response and next steps. It involves quickly evaluating the severity, scope, and potential impact of an incident to allocate resources appropriately.",
                docLink: "https://docs.aws.amazon.com/security-ir/latest/userguide/concepts-and-terminology.html"
            },
            {
                id: 13,
                question: "What volatile data should be captured from a potentially compromised EC2 instance before isolation?",
                options: [
                    "Instance metadata including security groups, IAM role, and network interface details",
                    "Memory contents, running processes, network connections, and logged-in users",
                    "EBS volume snapshots capturing the complete disk state for forensic analysis",
                    "CloudTrail logs and VPC Flow Logs related to the instance's recent API activity"
                ],
                correct: 1,
                explanation: "Volatile data (data lost when the instance is stopped) includes memory contents, running processes, network connections, logged-in users, and open files. This data should be captured before isolation or shutdown using memory acquisition tools if forensic analysis of runtime state is required.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/operations.html"
            },
            {
                id: 14,
                question: "How should Network ACLs be configured for destination containment?",
                options: [
                    "Replace the existing NACL with a new one containing no rules for complete subnet isolation",
                    "Add explicit deny rules at the beginning of the NACL to block traffic to/from the target",
                    "Modify the default NACL rules to change from ALLOW to DENY for affected IP ranges",
                    "Associate a quarantine NACL that allows only management traffic from specific admin IPs"
                ],
                correct: 1,
                explanation: "Network ACL rules are processed in top-down order. For destination containment, add explicit deny rules at the beginning of the NACL (lowest rule numbers) to block unauthorized traffic to/from the targeted resource. Alternatively, create a new NACL with only deny rules and associate it with the subnet.",
                docLink: "https://docs.aws.amazon.com/security-ir/latest/userguide/destination-containment.html"
            },
            {
                id: 15,
                question: "What is 'eradication' in the incident response lifecycle?",
                options: [
                    "Isolating compromised resources from the network to prevent lateral movement",
                    "Removing the root cause and any artifacts or persistence mechanisms of the compromise",
                    "Restoring systems to normal operation after verifying they are clean",
                    "Documenting the incident timeline and creating a lessons learned report"
                ],
                correct: 1,
                explanation: "Eradication involves removing the root cause of the incident and any artifacts left by the attacker. This includes removing malware, closing vulnerabilities that were exploited, removing unauthorized access, and ensuring the attacker no longer has persistence mechanisms.",
                docLink: "https://docs.aws.amazon.com/security-ir/latest/userguide/concepts-and-terminology.html"
            },
            {
                id: 16,
                question: "What AWS service provides automated forensic capabilities for EC2 instances?",
                options: [
                    "AWS Config",
                    "Automated Forensics Orchestrator for Amazon EC2",
                    "Amazon Inspector",
                    "AWS Systems Manager"
                ],
                correct: 1,
                explanation: "Automated Forensics Orchestrator for Amazon EC2 and EKS is an AWS Solution that provides a self-service framework for SOC teams to capture and examine data from EC2 instances and attached volumes for forensic analysis. It orchestrates key forensics processes including isolation of affected instances, capture of memory and disk images to secure storage, and initiation of automated investigation tools.",
                docLink: "https://docs.aws.amazon.com/solutions/latest/automated-forensics-orchestrator-for-amazon-ec2/welcome.html"
            },
            {
                id: 17,
                question: "What should be documented during post-incident activity?",
                options: [
                    "A detailed timeline of events with timestamps for each containment action taken",
                    "Lessons learned, root cause analysis, and specific improvements to prevent recurrence",
                    "Names and roles of all responders along with their individual actions during the incident",
                    "Financial impact assessment including remediation costs and business disruption estimates"
                ],
                correct: 1,
                explanation: "Post-incident activity should document: timeline of events, actions taken, root cause analysis, lessons learned, and recommended improvements. This information feeds back into the preparation phase to improve future incident response capabilities.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/post-incident-activity.html"
            },
            {
                id: 18,
                question: "Why should you detach compromised EC2 instances from Auto Scaling groups during containment?",
                options: [
                    "To stop the instance from receiving traffic through the load balancer immediately",
                    "To prevent the Auto Scaling group from terminating the instance and destroying evidence",
                    "To allow the security team to modify the instance without triggering scaling policies",
                    "To reduce the blast radius by preventing the compromise from spreading to new instances"
                ],
                correct: 1,
                explanation: "You should detach compromised instances from Auto Scaling groups to prevent the group from terminating the instance (destroying forensic evidence) or launching replacement instances that might also be compromised. This also prevents the affected instance from serving traffic.",
                docLink: "https://docs.aws.amazon.com/security-ir/latest/userguide/destination-containment.html"
            },
            {
                id: 19,
                question: "What is 'Responder Generated Intelligence' in AWS Security Incident Response?",
                options: [
                    "Automated threat reports generated by GuardDuty using machine learning analysis",
                    "Indicators of compromise, TTPs, and patterns observed during AWS investigations",
                    "Log analysis insights produced by Amazon Detective's behavioral graph",
                    "Security findings aggregated and prioritized by Security Hub's scoring algorithm"
                ],
                correct: 1,
                explanation: "Responder Generated Intelligence includes indicators of compromise (IOCs), tactics, techniques, and procedures (TTPs), and associated patterns observed by AWS during investigations. This intelligence helps identify and respond to evolving security threats.",
                docLink: "https://docs.aws.amazon.com/security-ir/latest/userguide/concepts-and-terminology.html"
            },
            {
                id: 20,
                question: "What is the recommended approach for handling compromised IAM credentials?",
                options: [
                    "Monitor CloudTrail logs closely to understand attacker behavior before taking action",
                    "Immediately deactivate the credentials and review CloudTrail for recent unauthorized actions",
                    "Rotate the credentials to new values while keeping the existing ones temporarily active",
                    "Apply a restrictive IAM policy to the user that limits permissions to read-only access"
                ],
                correct: 1,
                explanation: "When IAM credentials are compromised, immediately deactivate or delete the affected credentials (access keys, passwords). Then review CloudTrail logs to understand what actions were taken with those credentials, and assess the blast radius of the compromise.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/operations.html"
            },
            {
                id: 21,
                question: "What is the purpose of 'game days' in incident response preparation?",
                options: [
                    "Tabletop exercises where teams discuss hypothetical scenarios without hands-on action",
                    "Simulated security incidents to practice response procedures in a realistic environment",
                    "Annual security awareness training required for compliance with industry regulations",
                    "Authorized penetration testing engagements to identify vulnerabilities before attackers"
                ],
                correct: 1,
                explanation: "Game days are simulated security incidents that help teams practice their incident response procedures in a controlled environment. They help identify gaps in runbooks, test communication channels, and ensure responders are familiar with tools and processes before a real incident occurs.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/preparation.html"
            },
            {
                id: 22,
                question: "How should you preserve evidence chain of custody in AWS?",
                options: [
                    "Store EBS snapshots and logs in the same account with versioning enabled for rollback",
                    "Document all access to evidence and store forensic artifacts in separate restricted accounts",
                    "Use CloudTrail to automatically track all API calls made during the investigation",
                    "Enable S3 Object Lock on all buckets to prevent modification of stored evidence"
                ],
                correct: 1,
                explanation: "Maintain chain of custody by: documenting all access to evidence (who, when, what), storing forensic artifacts (snapshots, logs) in a separate, restricted account, using write-once storage for logs, enabling MFA delete, and using cryptographic hashes to verify integrity.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/operations.html"
            },
            {
                id: 23,
                question: "What happens when you stop an EC2 instance for forensics?",
                options: [
                    "Both preserve all data identically since EBS volumes persist through either action",
                    "Stopping loses volatile data like memory but preserves EBS volumes for disk forensics",
                    "Stopping triggers a clean OS shutdown preserving more filesystem state than terminating",
                    "Stopping is preferred because it allows the instance to be restarted for live analysis"
                ],
                correct: 1,
                explanation: "Stopping an EC2 instance (normal stop) loses volatile data (memory, running processes) but preserves EBS volumes. For forensics, if you need volatile data, you must capture it before stopping. Stopping is often preferred to preserve disk evidence while preventing further network activity. Note: In AWS EC2, 'stopping' is the standard action; 'shutting down' typically refers to the OS-level shutdown command which results in the instance stopping.",
                docLink: "https://docs.aws.amazon.com/security-ir/latest/userguide/destination-containment.html"
            },
            {
                id: 24,
                question: "What should you review in CloudTrail when investigating a security incident?",
                options: [
                    "Failed API calls which indicate blocked attacker activity and permission errors",
                    "All relevant API calls including source IPs, user agents, timestamps, and affected resources",
                    "Management events only since data events are too voluminous for incident investigation",
                    "Events from the detection time window to limit the scope of investigation"
                ],
                correct: 1,
                explanation: "During investigation, review all relevant CloudTrail events including: API calls by the suspected compromised identity, source IP addresses, user agents, affected resources, timestamps, and both successful and failed attempts. This helps establish the timeline and scope of the incident.",
                docLink: "https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/operations.html"
            },
            {
                id: 25,
                question: "What is the role of AWS Support during a security incident?",
                options: [
                    "AWS Support is only available for infrastructure issues, not customer security incidents",
                    "Business or Enterprise Support provides guidance with Enterprise including TAM and expert access",
                    "AWS Support proactively monitors and automatically remediates security threats in your account",
                    "AWS Support provides incident response only through the separately purchased Security Hub service"
                ],
                correct: 1,
                explanation: "AWS Business and Enterprise Support customers can receive guidance during security incidents. Enterprise Support includes access to a Technical Account Manager (TAM) and, with the AWS Security Incident Response service, 24/7 access to security experts for active incident support.",
                docLink: "https://docs.aws.amazon.com/security-ir/latest/userguide/concepts-and-terminology.html"
            }
        ];

        let currentMode = 'learn', currentQuestion = 0, userAnswers = [], answersRevealed = [], shuffledQuestions = [], timerInterval = null, timeRemaining = 0, inReviewMode = false, reviewedQuestions = [];
        function shuffleArray(array) { const a = [...array]; for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; } return a; }
        function shuffleQuestionOptions(q) { const idx = shuffleArray([0,1,2,3]); return { ...q, options: idx.map(i => q.options[i]), correct: idx.indexOf(q.correct) }; }
        function startQuiz(mode) { inReviewMode = false; reviewedQuestions = []; currentMode = mode; currentQuestion = 0; userAnswers = new Array(questions.length).fill(null); answersRevealed = new Array(questions.length).fill(false); shuffledQuestions = shuffleArray(questions).map(shuffleQuestionOptions); document.getElementById('modeSelector').classList.add('hidden'); document.getElementById('quizContent').classList.remove('hidden'); document.getElementById('resultsCard').classList.remove('show'); document.getElementById('totalQ').textContent = shuffledQuestions.length; document.getElementById('reviewSection').classList.remove('show'); document.getElementById('backToReviewBtn').style.display = 'none'; if (mode === 'exam') { timeRemaining = shuffledQuestions.length * 150; startTimer(); document.getElementById('shuffleBtn').classList.add('hidden'); } else { document.getElementById('timer').textContent = 'Learn Mode'; document.getElementById('shuffleBtn').classList.remove('hidden'); } renderQuestion(); }
        function startTimer() { updateTimerDisplay(); timerInterval = setInterval(() => { timeRemaining--; updateTimerDisplay(); if (timeRemaining <= 0) { clearInterval(timerInterval); showResults(); } }, 1000); }
        function updateTimerDisplay() { const m = Math.floor(timeRemaining / 60), s = timeRemaining % 60, el = document.getElementById('timer'); el.textContent = `${m}:${s.toString().padStart(2, '0')}`; el.classList.remove('warning', 'danger'); if (timeRemaining <= 60) el.classList.add('danger'); else if (timeRemaining <= 300) el.classList.add('warning'); }
        function renderQuestion() { const q = shuffledQuestions[currentQuestion], c = document.getElementById('questionsContainer'), letters = ['A','B','C','D'], ua = userAnswers[currentQuestion], revealed = answersRevealed[currentQuestion]; let opts = q.options.map((o,i) => { let cls = 'option'; if (currentMode === 'learn' && revealed) { cls += ' disabled'; if (i === q.correct) cls += ' correct'; else if (i === ua && ua !== q.correct) cls += ' incorrect'; } else if (ua === i) cls += ' selected'; return `<div class="${cls}" onclick="selectOption(${i})"><span class="option-marker">${letters[i]}</span><span class="option-text">${o}</span></div>`; }).join(''); let exp = currentMode === 'learn' ? `<div class="explanation ${revealed ? 'show' : ''}"><div class="explanation-title">üìñ Explanation</div><div class="answer-header">Correct Answer: ${letters[q.correct]}</div><p class="explanation-text">${q.explanation}</p><a href="${q.docLink}" target="_blank" class="doc-link">üìÑ View AWS Documentation ‚Üí</a></div>` : ''; c.innerHTML = `<div class="question-card"><div class="question-header"><span class="question-number">Question ${currentQuestion + 1}</span><span class="question-domain">Incident Response</span></div><p class="question-text">${q.question}</p><div class="options">${opts}</div>${currentMode === 'learn' && !revealed ? '<button class="btn btn-primary" style="margin-top: 1rem; width: 100%;" onclick="revealAnswer()">Show Answer</button>' : ''}${exp}</div>`; document.getElementById('currentQ').textContent = currentQuestion + 1; document.getElementById('progressFill').style.width = `${((currentQuestion + 1) / shuffledQuestions.length) * 100}%`; document.getElementById('prevBtn').disabled = currentQuestion === 0; document.getElementById('nextBtn').textContent = currentQuestion === shuffledQuestions.length - 1 ? (currentMode === 'exam' ? 'Submit Quiz' : 'See Results') : 'Next ‚Üí'; }
        function selectOption(i) { if (currentMode === 'learn' && answersRevealed[currentQuestion]) return; userAnswers[currentQuestion] = i; renderQuestion(); }
        function revealAnswer() { if (userAnswers[currentQuestion] === null) userAnswers[currentQuestion] = -1; answersRevealed[currentQuestion] = true; renderQuestion(); }
        function navigate(d) { if (d === 1 && currentQuestion === shuffledQuestions.length - 1) { showResults(); return; } currentQuestion = Math.max(0, Math.min(currentQuestion + d, shuffledQuestions.length - 1)); renderQuestion(); }
        function shuffleQuiz() { if (currentMode !== 'learn') return; currentQuestion = 0; userAnswers = new Array(questions.length).fill(null); answersRevealed = new Array(questions.length).fill(false); shuffledQuestions = shuffleArray(questions).map(shuffleQuestionOptions); renderQuestion(); }
        function showResults() { if (timerInterval) clearInterval(timerInterval); let correct = shuffledQuestions.reduce((c, q, i) => c + (userAnswers[i] !== null && userAnswers[i] !== -1 && userAnswers[i] === q.correct ? 1 : 0), 0); const total = shuffledQuestions.length, pct = Math.round((correct / total) * 100), passed = pct >= 80; document.getElementById('quizContent').classList.add('hidden'); document.getElementById('reviewSection').classList.remove('show'); document.getElementById('resultsCard').classList.add('show'); const se = document.getElementById('scorePercent'); se.textContent = pct + '%'; se.className = 'results-score ' + (passed ? 'pass' : 'fail'); const st = document.getElementById('resultStatus'); st.textContent = passed ? 'üéâ PASSED!' : 'üìö Keep Studying'; st.className = 'results-status ' + (passed ? 'pass' : 'fail'); document.getElementById('resultDetails').textContent = `You answered ${correct} out of ${total} questions correctly.`; document.getElementById('correctCount').textContent = correct; document.getElementById('incorrectCount').textContent = total - correct; document.getElementById('reviewBtn').style.display = currentMode === 'exam' ? 'inline-block' : 'none'; }
        function restartQuiz() { document.getElementById('resultsCard').classList.remove('show'); document.getElementById('reviewSection').classList.remove('show'); document.getElementById('backToReviewBtn').style.display = 'none'; document.getElementById('modeSelector').classList.remove('hidden'); document.getElementById('quizContent').classList.add('hidden'); if (timerInterval) clearInterval(timerInterval); inReviewMode = false; reviewedQuestions = []; }
        function showReview() { const letters = ['A','B','C','D']; const tbody = document.getElementById('reviewTableBody'); tbody.innerHTML = shuffledQuestions.map((q, i) => { const userAns = userAnswers[i]; const isCorrect = userAns === q.correct; const userLetter = userAns !== null && userAns >= 0 ? letters[userAns] : 'No Answer'; const correctLetter = letters[q.correct]; const statusIcon = isCorrect ? '‚úì' : '‚úó'; const statusClass = isCorrect ? 'correct' : 'incorrect'; const qText = q.question.length > 120 ? q.question.substring(0, 120) + '...' : q.question; const reviewedClass = reviewedQuestions.includes(i) ? 'reviewed' : ''; return `<tr class="${reviewedClass}" onclick="reviewQuestion(${i})"><td class="review-q-num">${i + 1}</td><td class="review-q-text">${qText}</td><td class="review-answer ${userAns === q.correct ? 'correct' : 'incorrect'}">${userLetter}</td><td class="review-answer correct">${correctLetter}</td><td class="review-status ${statusClass}">${statusIcon}</td></tr>`; }).join(''); document.getElementById('resultsCard').classList.remove('show'); document.getElementById('reviewSection').classList.add('show'); inReviewMode = true; }
        function reviewQuestion(qIndex) { if (!reviewedQuestions.includes(qIndex)) { reviewedQuestions.push(qIndex); } currentMode = 'learn'; currentQuestion = qIndex; answersRevealed[qIndex] = true; document.getElementById('reviewSection').classList.remove('show'); document.getElementById('quizContent').classList.remove('hidden'); document.getElementById('timer').textContent = 'Learn Mode'; document.getElementById('shuffleBtn').style.display = 'none'; document.getElementById('backToReviewBtn').style.display = 'inline-block'; if (timerInterval) clearInterval(timerInterval); renderQuestion(); }
        function backToReview() { document.getElementById('quizContent').classList.add('hidden'); showReview(); }
        function backToResults() { document.getElementById('reviewSection').classList.remove('show'); document.getElementById('resultsCard').classList.add('show'); inReviewMode = false; }
    </script>
</body>
</html>
