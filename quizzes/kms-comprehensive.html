<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS KMS Quiz | AWS Security Specialty (SCS-C03)</title>
    <style>
        :root { --bg-primary: #0a0e17; --bg-secondary: #141b2d; --bg-tertiary: #1a2236; --text-primary: #e2e8f0; --text-secondary: #94a3b8; --accent-primary: #10b981; --accent-secondary: #34d399; --success: #22c55e; --error: #ef4444; --warning: #eab308; --info: #3b82f6; --border: #2d3a52; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg-primary); color: var(--text-primary); line-height: 1.6; min-height: 100vh; }
        .container { max-width: 900px; margin: 0 auto; padding: 2rem; }
        header { text-align: center; margin-bottom: 2rem; padding: 2rem; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%); border-radius: 16px; border: 1px solid var(--border); }
        .badge { display: inline-block; background: var(--accent-primary); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; margin-bottom: 1rem; text-transform: uppercase; }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .subtitle { color: var(--text-secondary); font-size: 1rem; }
        .stats-bar { display: flex; justify-content: center; gap: 2rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border); }
        .stat { text-align: center; } .stat-value { font-size: 1.5rem; font-weight: 700; color: var(--accent-primary); } .stat-label { font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; }
        .mode-selector { display: flex; gap: 1rem; justify-content: center; margin-bottom: 2rem; }
        .mode-btn { padding: 0.75rem 2rem; border: 2px solid var(--border); background: var(--bg-secondary); color: var(--text-primary); border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease; }
        .mode-btn:hover { border-color: var(--accent-primary); background: var(--bg-tertiary); }
        .progress-container { background: var(--bg-secondary); border-radius: 12px; padding: 1rem 1.5rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
        .progress-text { font-size: 0.875rem; color: var(--text-secondary); }
        .timer { font-size: 1.25rem; font-weight: 600; color: var(--accent-primary); font-family: 'Consolas', monospace; }
        .timer.warning { color: var(--warning); animation: pulse 1s infinite; } .timer.danger { color: var(--error); animation: pulse 0.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .progress-bar { height: 8px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary)); border-radius: 4px; transition: width 0.3s ease; }
        .question-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .question-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
        .question-number { background: var(--bg-tertiary); color: var(--accent-primary); padding: 0.25rem 0.75rem; border-radius: 6px; font-size: 0.875rem; font-weight: 600; }
        .question-domain { font-size: 0.75rem; color: var(--text-secondary); background: var(--bg-tertiary); padding: 0.25rem 0.5rem; border-radius: 4px; }
        .question-text { font-size: 1.125rem; margin-bottom: 1.5rem; line-height: 1.7; }
        .options { display: flex; flex-direction: column; gap: 0.75rem; }
        .option { display: flex; align-items: flex-start; gap: 1rem; padding: 1rem; background: var(--bg-tertiary); border: 2px solid var(--border); border-radius: 10px; cursor: pointer; transition: all 0.2s ease; }
        .option:hover:not(.disabled) { border-color: var(--accent-primary); background: rgba(16, 185, 129, 0.1); }
        .option.selected { border-color: var(--accent-primary); background: rgba(16, 185, 129, 0.15); }
        .option.correct { border-color: var(--success); background: rgba(34, 197, 94, 0.15); }
        .option.incorrect { border-color: var(--error); background: rgba(239, 68, 68, 0.15); }
        .option.disabled { cursor: default; }
        .option-marker { width: 28px; height: 28px; border-radius: 50%; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; flex-shrink: 0; }
        .option.selected .option-marker { border-color: var(--accent-primary); background: var(--accent-primary); color: white; }
        .option.correct .option-marker { border-color: var(--success); background: var(--success); color: white; }
        .option.incorrect .option-marker { border-color: var(--error); background: var(--error); color: white; }
        .option-text { flex: 1; padding-top: 2px; }
        .explanation { margin-top: 1.5rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; border-left: 4px solid var(--info); display: none; }
        .explanation.show { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .explanation-title { display: flex; align-items: center; gap: 0.5rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--info); }
        .answer-header { font-weight: 600; color: var(--success); margin-bottom: 0.5rem; }
        .explanation-text { color: var(--text-secondary); margin-bottom: 1rem; }
        .doc-link { display: inline-flex; align-items: center; gap: 0.5rem; color: var(--accent-primary); text-decoration: none; font-size: 0.875rem; padding: 0.5rem 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 6px; }
        .doc-link:hover { background: rgba(16, 185, 129, 0.2); }
        .btn-container { display: flex; justify-content: space-between; gap: 1rem; margin-top: 1rem; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
        .btn-primary { background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4); }
        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); }
        .btn-secondary:hover { border-color: var(--accent-primary); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .results-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; text-align: center; border: 1px solid var(--border); display: none; }
        .results-card.show { display: block; animation: fadeIn 0.5s ease; }
        .results-score { font-size: 4rem; font-weight: 700; margin: 1rem 0; }
        .results-score.pass { color: var(--success); } .results-score.fail { color: var(--error); }
        .results-status { font-size: 1.5rem; margin-bottom: 1rem; }
        .results-status.pass { color: var(--success); } .results-status.fail { color: var(--error); }
        .results-details { color: var(--text-secondary); margin-bottom: 2rem; }
        .results-breakdown { display: flex; justify-content: center; gap: 3rem; margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; }
        .breakdown-item { text-align: center; } .breakdown-value { font-size: 2rem; font-weight: 700; } .breakdown-value.correct { color: var(--success); } .breakdown-value.incorrect { color: var(--error); } .breakdown-label { font-size: 0.875rem; color: var(--text-secondary); }
        .hidden { display: none !important; }
        .shuffle-notice { text-align: center; padding: 0.75rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px; margin-bottom: 1.5rem; color: var(--accent-secondary); font-size: 0.875rem; }
        @media (max-width: 640px) { .container { padding: 1rem; } h1 { font-size: 1.5rem; } .stats-bar { gap: 1rem; } .mode-selector, .btn-container, .results-breakdown { flex-direction: column; } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <span class="badge">Domain 5: Data Protection (18%)</span>
            <h1>AWS Key Management Service (KMS)</h1>
            <p class="subtitle">Comprehensive Quiz for AWS Security Specialty (SCS-C03)</p>
            <div class="stats-bar">
                <div class="stat"><div class="stat-value">25</div><div class="stat-label">Questions</div></div>
                <div class="stat"><div class="stat-value">80%</div><div class="stat-label">Pass Score</div></div>
                <div class="stat"><div class="stat-value">62:30</div><div class="stat-label">Exam Time</div></div>
            </div>
        </header>
        <div class="mode-selector" id="modeSelector">
            <button class="mode-btn" onclick="startQuiz('learn')">üìö Learn Mode</button>
            <button class="mode-btn" onclick="startQuiz('exam')">‚è±Ô∏è Exam Mode</button>
        </div>
        <div id="quizContent" class="hidden">
            <div class="progress-container">
                <div class="progress-header">
                    <span class="progress-text">Question <span id="currentQ">1</span> of <span id="totalQ">25</span></span>
                    <span class="timer" id="timer">62:30</span>
                </div>
                <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width: 0%"></div></div>
            </div>
            <div class="shuffle-notice" id="shuffleNotice">üîÄ Questions and options have been randomized</div>
            <div id="questionsContainer"></div>
            <div class="btn-container">
                <button class="btn btn-secondary" id="prevBtn" onclick="navigate(-1)" disabled>‚Üê Previous</button>
                <button class="btn btn-secondary" id="shuffleBtn" onclick="shuffleQuiz()">üîÄ Shuffle</button>
                <button class="btn btn-primary" id="nextBtn" onclick="navigate(1)">Next ‚Üí</button>
            </div>
        </div>
        <div class="results-card" id="resultsCard">
            <h2>Quiz Complete!</h2>
            <div class="results-score" id="scorePercent">0%</div>
            <div class="results-status" id="resultStatus">-</div>
            <p class="results-details" id="resultDetails"></p>
            <div class="results-breakdown">
                <div class="breakdown-item"><div class="breakdown-value correct" id="correctCount">0</div><div class="breakdown-label">Correct</div></div>
                <div class="breakdown-item"><div class="breakdown-value incorrect" id="incorrectCount">0</div><div class="breakdown-label">Incorrect</div></div>
            </div>
            <button class="btn btn-primary" onclick="restartQuiz()">üîÑ Restart Quiz</button>
        </div>
    </div>
    <script>
        const questions = [
            { id: 1, question: "What are the three types of KMS keys based on management?", options: ["Primary keys, Secondary keys, Backup keys", "Customer managed keys, AWS managed keys, AWS owned keys", "Root keys, Data keys, Master keys", "Encryption keys, Decryption keys, Signing keys"], correct: 1, explanation: "KMS has three key types: Customer managed keys (you create and manage), AWS managed keys (created by AWS services on your behalf), and AWS owned keys (used internally by AWS across multiple accounts, like SSE-S3).", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html" },
            { id: 2, question: "What is the maximum size of data that can be encrypted directly with KMS Encrypt API?", options: ["256 bytes", "4 KB", "10 KB", "1 MB"], correct: 1, explanation: "KMS can only directly encrypt up to 4 KB of data with the Encrypt API. For larger data, you must use envelope encryption - generating a data key with GenerateDataKey and using that key to encrypt your data locally.", docLink: "https://docs.aws.amazon.com/kms/latest/APIReference/API_Encrypt.html" },
            { id: 3, question: "What is envelope encryption in AWS KMS?", options: ["Encrypting the same data multiple times", "Using a data key to encrypt data, then encrypting the data key with a KMS key", "Encrypting only email attachments", "A method to encrypt data in transit"], correct: 1, explanation: "Envelope encryption uses a two-tier approach: A data key (plaintext) encrypts your actual data locally, then KMS encrypts that data key with your KMS key. You store the encrypted data key alongside your encrypted data.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html#enveloping" },
            { id: 4, question: "What is the purpose of the GenerateDataKeyWithoutPlaintext API?", options: ["Generate a data key that cannot be decrypted", "Generate only the encrypted data key, not the plaintext version", "Generate a key for data that doesn't need encryption", "Generate a temporary key that expires"], correct: 1, explanation: "GenerateDataKeyWithoutPlaintext returns only the encrypted data key, not the plaintext. This is used when you want to store a data key for later use but don't need to encrypt data immediately. You must call Decrypt later to get the plaintext key.", docLink: "https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKeyWithoutPlaintext.html" },
            { id: 5, question: "How often does automatic KMS key rotation occur for customer managed keys?", options: ["Every 30 days", "Every 90 days", "Every 365 days (1 year)", "Every 3 years"], correct: 2, explanation: "Automatic key rotation for customer managed symmetric keys occurs every 365 days (1 year). When rotated, KMS creates new cryptographic material but retains the old material to decrypt data encrypted with previous versions.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html" },
            { id: 6, question: "What is a KMS key policy?", options: ["An IAM policy attached to users", "A resource-based policy that controls access to the KMS key", "A policy that defines encryption algorithms", "A policy for key rotation"], correct: 1, explanation: "A KMS key policy is a resource-based policy attached directly to a KMS key. It defines who can use and manage the key. Unlike most AWS services, KMS requires key policies - IAM policies alone cannot grant access unless the key policy allows it.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/key-policies.html" },
            { id: 7, question: "What is the purpose of KMS grants?", options: ["To permanently grant key access", "To provide temporary, delegated access without modifying key policies", "To grant access to all keys in an account", "To bypass key policies"], correct: 1, explanation: "KMS grants provide temporary, delegated access to a KMS key without modifying the key policy. They're commonly used by AWS services that need to use your key on your behalf, and can be retired when no longer needed.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/grants.html" },
            { id: 8, question: "What is an encryption context in KMS?", options: ["The AWS region where encryption occurs", "Optional key-value pairs that provide additional authenticated data (AAD)", "The name of the encryption algorithm", "The time when encryption happened"], correct: 1, explanation: "Encryption context is optional key-value pairs that serve as additional authenticated data (AAD). It's bound cryptographically to the ciphertext - you must provide the same encryption context for decryption. It appears in CloudTrail logs for auditing.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html#encrypt_context" },
            { id: 9, question: "What happens to data encrypted with a KMS key when the key is deleted?", options: ["Data is automatically decrypted", "Data becomes permanently unrecoverable", "Data is backed up before deletion", "Nothing - data can still be decrypted"], correct: 1, explanation: "Deleting a KMS key makes all data encrypted with that key permanently unrecoverable. This is why KMS has a mandatory waiting period (7-30 days) before deletion, giving you time to verify the key is no longer needed.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys.html" },
            { id: 10, question: "What is a Custom Key Store in KMS?", options: ["A separate AWS account for keys", "A way to store KMS keys in your own CloudHSM cluster", "A backup location for keys", "An on-premises key storage"], correct: 1, explanation: "A Custom Key Store lets you store KMS keys in an AWS CloudHSM cluster that you control. This provides the convenience of KMS with the added control of CloudHSM. Keys never leave the HSM in plaintext.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/custom-key-store-overview.html" },
            { id: 11, question: "Which KMS key type allows you to import your own key material?", options: ["AWS managed keys", "AWS owned keys", "Customer managed keys with imported key material", "All KMS key types"], correct: 2, explanation: "You can import your own key material into customer managed KMS keys. This gives you control over key material generation and allows you to set an expiration date. However, imported key material doesn't support automatic rotation.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/importing-keys.html" },
            { id: 12, question: "What is the difference between symmetric and asymmetric KMS keys?", options: ["Symmetric keys are longer than asymmetric keys", "Symmetric uses one key; asymmetric uses a public/private key pair", "Asymmetric keys are only for signing", "There is no difference"], correct: 1, explanation: "Symmetric KMS keys use the same 256-bit AES key for encryption and decryption. Asymmetric keys use a mathematically related public/private key pair - you can distribute the public key for encryption while keeping the private key secure in KMS.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/symmetric-asymmetric.html" },
            { id: 13, question: "What operations can an asymmetric KMS key perform?", options: ["Only encryption", "Only signing", "Encryption OR signing, depending on key usage", "Both encryption and signing with the same key"], correct: 2, explanation: "An asymmetric KMS key can be used for EITHER encryption/decryption OR signing/verification, but not both. You specify the key usage when creating the key. This enforces separation of duties and security best practices.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/symmetric-asymmetric.html" },
            { id: 14, question: "What is the kms:ViaService condition key used for?", options: ["To specify which VPC the key can be used in", "To restrict key usage to requests from specific AWS services", "To track which service created the key", "To limit key usage to specific regions"], correct: 1, explanation: "kms:ViaService restricts key usage to requests that come from specific AWS services. For example, you can allow a key to only be used by S3 (s3.us-east-1.amazonaws.com), preventing direct API calls to encrypt/decrypt.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/policy-conditions.html#conditions-kms-via-service" },
            { id: 15, question: "What is a multi-Region KMS key?", options: ["A key that automatically replicates to all regions", "Related keys in different regions that can decrypt each other's ciphertext", "A key stored in multiple availability zones", "A key that works with global AWS services"], correct: 1, explanation: "Multi-Region keys are a set of interoperable KMS keys in different regions with the same key material. Data encrypted in one region can be decrypted in another region using the related multi-Region key. Useful for disaster recovery and global applications.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/multi-region-keys-overview.html" },
            { id: 16, question: "What is the default key policy when you create a KMS key?", options: ["No permissions - must add all permissions manually", "Allows the root user full access and enables IAM policies", "Allows all IAM users full access", "Only allows the key creator access"], correct: 1, explanation: "The default key policy gives the AWS account (root user) full access to the key and enables IAM policies to grant key permissions. Without this default, you'd need to specify all permissions in the key policy itself.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/key-policies.html#key-policy-default" },
            { id: 17, question: "What is key aliasing in KMS?", options: ["Creating multiple copies of a key", "A friendly name (alias/key-name) that points to a KMS key", "Hiding the key ID for security", "Linking keys across accounts"], correct: 1, explanation: "A key alias is a friendly name (like alias/my-key) that points to a KMS key. Aliases make it easier to refer to keys and can be updated to point to different keys without changing your code. Each alias can only point to one key.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/kms-alias.html" },
            { id: 18, question: "What CloudTrail information is logged for KMS API calls?", options: ["Only failed API calls", "All API calls including encryption context", "Only calls from the console", "No KMS calls are logged"], correct: 1, explanation: "KMS logs all API calls to CloudTrail, including the key ID, encryption context (if provided), and the principal making the request. This provides a complete audit trail of all key usage for compliance and security analysis.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/logging-using-cloudtrail.html" },
            { id: 19, question: "What is the purpose of kms:GrantConstraintType in grant conditions?", options: ["To limit the size of grants", "To require encryption context in operations performed under the grant", "To restrict grant creation time", "To limit the number of grants"], correct: 1, explanation: "Grant constraints like EncryptionContextEquals or EncryptionContextSubset require specific encryption context values for operations performed using the grant. This provides fine-grained access control based on the encryption context.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/grant-manage.html" },
            { id: 20, question: "How do you enable automatic key rotation for a customer managed key?", options: ["It's enabled by default", "Call EnableKeyRotation API or use console", "Contact AWS support", "Import new key material"], correct: 1, explanation: "You enable automatic rotation by calling EnableKeyRotation API or through the console. Once enabled, KMS automatically rotates the key material every 365 days while retaining old material for decryption.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html#rotating-keys-enable-disable" },
            { id: 21, question: "What is the ReEncrypt API used for?", options: ["To encrypt data again with the same key", "To decrypt and re-encrypt data under a different KMS key without exposing plaintext", "To reset encryption", "To compress and encrypt data"], correct: 1, explanation: "ReEncrypt decrypts ciphertext encrypted under one KMS key and re-encrypts it under a different key, all within KMS. The plaintext is never exposed to the caller, making it ideal for key migration or changing encryption contexts.", docLink: "https://docs.aws.amazon.com/kms/latest/APIReference/API_ReEncrypt.html" },
            { id: 22, question: "What is the waiting period for KMS key deletion?", options: ["Immediate deletion", "7-30 days configurable waiting period", "90 days fixed", "1 year"], correct: 1, explanation: "KMS key deletion has a configurable waiting period of 7-30 days. During this time, the key is disabled and can be recovered. After the waiting period, the key and all data encrypted with it are permanently unrecoverable.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys.html" },
            { id: 23, question: "What is the purpose of the kms:CallerAccount condition key?", options: ["To track which account created the key", "To restrict key usage to specific AWS accounts", "To log account information", "To enable cross-account access"], correct: 1, explanation: "kms:CallerAccount restricts which AWS accounts can use the key. This is useful in cross-account scenarios where you want to allow access from specific accounts only, even if the principal ARN changes.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/policy-conditions.html#conditions-kms-caller-account" },
            { id: 24, question: "Can you use asymmetric KMS keys outside of AWS?", options: ["No, all KMS operations must happen in AWS", "Yes, you can download and use the public key outside AWS", "Only with special approval from AWS", "Only for signing, not encryption"], correct: 1, explanation: "You can download the public key of an asymmetric KMS key and use it outside AWS for encryption or verification. The private key never leaves KMS, so decryption and signing must happen in AWS.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/download-public-key.html" },
            { id: 25, question: "What is HMAC in KMS context?", options: ["A type of encryption algorithm", "Hardware Management and Access Control", "A key type for generating and verifying message authentication codes", "High Memory Access Control"], correct: 2, explanation: "KMS HMAC keys are symmetric keys used to generate and verify Hash-based Message Authentication Codes (HMACs). They ensure message integrity and authenticity. HMAC operations (GenerateMac, VerifyMac) happen entirely within KMS.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/hmac.html" }
        ];

        let currentMode = 'learn', currentQuestion = 0, userAnswers = [], shuffledQuestions = [], timerInterval = null, timeRemaining = 0;
        function shuffleArray(a) { const b = [...a]; for (let i = b.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [b[i], b[j]] = [b[j], b[i]]; } return b; }
        function shuffleQuestionOptions(q) { const idx = shuffleArray([0,1,2,3]); return { ...q, options: idx.map(i => q.options[i]), correct: idx.indexOf(q.correct) }; }
        function startQuiz(mode) { currentMode = mode; currentQuestion = 0; userAnswers = new Array(questions.length).fill(null); shuffledQuestions = shuffleArray(questions).map(shuffleQuestionOptions); document.getElementById('modeSelector').classList.add('hidden'); document.getElementById('quizContent').classList.remove('hidden'); document.getElementById('resultsCard').classList.remove('show'); document.getElementById('totalQ').textContent = shuffledQuestions.length; if (mode === 'exam') { timeRemaining = shuffledQuestions.length * 150; startTimer(); document.getElementById('shuffleBtn').classList.add('hidden'); } else { document.getElementById('timer').textContent = 'Learn Mode'; document.getElementById('shuffleBtn').classList.remove('hidden'); } renderQuestion(); }
        function startTimer() { updateTimerDisplay(); timerInterval = setInterval(() => { timeRemaining--; updateTimerDisplay(); if (timeRemaining <= 0) { clearInterval(timerInterval); showResults(); } }, 1000); }
        function updateTimerDisplay() { const m = Math.floor(timeRemaining / 60), s = timeRemaining % 60, el = document.getElementById('timer'); el.textContent = `${m}:${s.toString().padStart(2, '0')}`; el.classList.remove('warning', 'danger'); if (timeRemaining <= 60) el.classList.add('danger'); else if (timeRemaining <= 300) el.classList.add('warning'); }
        function renderQuestion() { const q = shuffledQuestions[currentQuestion], letters = ['A','B','C','D'], ans = userAnswers[currentQuestion]; let opts = q.options.map((o, i) => { let c = 'option'; if (currentMode === 'learn' && ans !== null) { c += ' disabled'; if (i === q.correct) c += ' correct'; else if (i === ans) c += ' incorrect'; } else if (ans === i) c += ' selected'; return `<div class="${c}" onclick="selectOption(${i})"><span class="option-marker">${letters[i]}</span><span class="option-text">${o}</span></div>`; }).join(''); let exp = currentMode === 'learn' ? `<div class="explanation ${ans !== null ? 'show' : ''}"><div class="explanation-title">üìñ Explanation</div><div class="answer-header">Correct Answer: ${letters[q.correct]}</div><p class="explanation-text">${q.explanation}</p><a href="${q.docLink}" target="_blank" class="doc-link">üìÑ View AWS Documentation ‚Üí</a></div>` : ''; document.getElementById('questionsContainer').innerHTML = `<div class="question-card"><div class="question-header"><span class="question-number">Question ${currentQuestion + 1}</span><span class="question-domain">KMS</span></div><p class="question-text">${q.question}</p><div class="options">${opts}</div>${currentMode === 'learn' && ans === null ? '<button class="btn btn-primary" style="margin-top:1rem;width:100%;" onclick="revealAnswer()">Show Answer</button>' : ''}${exp}</div>`; document.getElementById('currentQ').textContent = currentQuestion + 1; document.getElementById('progressFill').style.width = `${((currentQuestion + 1) / shuffledQuestions.length) * 100}%`; document.getElementById('prevBtn').disabled = currentQuestion === 0; document.getElementById('nextBtn').textContent = currentQuestion === shuffledQuestions.length - 1 ? (currentMode === 'exam' ? 'Submit Quiz' : 'See Results') : 'Next ‚Üí'; }
        function selectOption(i) { if (currentMode === 'learn' && userAnswers[currentQuestion] !== null) return; userAnswers[currentQuestion] = i; if (currentMode === 'exam') renderQuestion(); }
        function revealAnswer() { if (userAnswers[currentQuestion] === null) userAnswers[currentQuestion] = -1; renderQuestion(); }
        function navigate(d) { if (d === 1 && currentQuestion === shuffledQuestions.length - 1) { showResults(); return; } currentQuestion = Math.max(0, Math.min(currentQuestion + d, shuffledQuestions.length - 1)); renderQuestion(); }
        function shuffleQuiz() { if (currentMode !== 'learn') return; currentQuestion = 0; userAnswers = new Array(questions.length).fill(null); shuffledQuestions = shuffleArray(questions).map(shuffleQuestionOptions); renderQuestion(); }
        function showResults() { if (timerInterval) clearInterval(timerInterval); let correct = shuffledQuestions.reduce((c, q, i) => c + (userAnswers[i] === q.correct ? 1 : 0), 0); const total = shuffledQuestions.length, pct = Math.round((correct / total) * 100), pass = pct >= 80; document.getElementById('quizContent').classList.add('hidden'); document.getElementById('resultsCard').classList.add('show'); document.getElementById('scorePercent').textContent = pct + '%'; document.getElementById('scorePercent').className = 'results-score ' + (pass ? 'pass' : 'fail'); document.getElementById('resultStatus').textContent = pass ? 'üéâ PASSED!' : 'üìö Keep Studying'; document.getElementById('resultStatus').className = 'results-status ' + (pass ? 'pass' : 'fail'); document.getElementById('resultDetails').textContent = `You answered ${correct} out of ${total} questions correctly.`; document.getElementById('correctCount').textContent = correct; document.getElementById('incorrectCount').textContent = total - correct; }
        function restartQuiz() { document.getElementById('resultsCard').classList.remove('show'); document.getElementById('modeSelector').classList.remove('hidden'); document.getElementById('quizContent').classList.add('hidden'); if (timerInterval) clearInterval(timerInterval); }
    </script>
</body>
</html>
