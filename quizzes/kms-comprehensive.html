<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS KMS Quiz | AWS Security Specialty (SCS-C03)</title>
    <style>
        :root { --bg-primary: #0a0e17; --bg-secondary: #141b2d; --bg-tertiary: #1a2236; --text-primary: #e2e8f0; --text-secondary: #94a3b8; --accent-primary: #10b981; --accent-secondary: #34d399; --success: #22c55e; --error: #ef4444; --warning: #eab308; --info: #3b82f6; --border: #2d3a52; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg-primary); color: var(--text-primary); line-height: 1.6; min-height: 100vh; }
        .container { max-width: 900px; margin: 0 auto; padding: 2rem; }
        header { text-align: center; margin-bottom: 2rem; padding: 2rem; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%); border-radius: 16px; border: 1px solid var(--border); }
        .badge { display: inline-block; background: var(--accent-primary); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; margin-bottom: 1rem; text-transform: uppercase; }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .subtitle { color: var(--text-secondary); font-size: 1rem; }
        .stats-bar { display: flex; justify-content: center; gap: 2rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border); }
        .stat { text-align: center; } .stat-value { font-size: 1.5rem; font-weight: 700; color: var(--accent-primary); } .stat-label { font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; }
        .mode-selector { display: flex; gap: 1rem; justify-content: center; margin-bottom: 2rem; }
        .mode-btn { padding: 0.75rem 2rem; border: 2px solid var(--border); background: var(--bg-secondary); color: var(--text-primary); border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease; }
        .mode-btn:hover { border-color: var(--accent-primary); background: var(--bg-tertiary); }
        .progress-container { background: var(--bg-secondary); border-radius: 12px; padding: 1rem 1.5rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
        .progress-text { font-size: 0.875rem; color: var(--text-secondary); }
        .timer { font-size: 1.25rem; font-weight: 600; color: var(--accent-primary); font-family: 'Consolas', monospace; }
        .timer.warning { color: var(--warning); animation: pulse 1s infinite; } .timer.danger { color: var(--error); animation: pulse 0.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .progress-bar { height: 8px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary)); border-radius: 4px; transition: width 0.3s ease; }
        .question-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .question-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
        .question-number { background: var(--bg-tertiary); color: var(--accent-primary); padding: 0.25rem 0.75rem; border-radius: 6px; font-size: 0.875rem; font-weight: 600; }
        .question-domain { font-size: 0.75rem; color: var(--text-secondary); background: var(--bg-tertiary); padding: 0.25rem 0.5rem; border-radius: 4px; }
        .question-text { font-size: 1.125rem; margin-bottom: 1.5rem; line-height: 1.7; }
        .options { display: flex; flex-direction: column; gap: 0.75rem; }
        .option { display: flex; align-items: flex-start; gap: 1rem; padding: 1rem; background: var(--bg-tertiary); border: 2px solid var(--border); border-radius: 10px; cursor: pointer; transition: all 0.2s ease; }
        .option:hover:not(.disabled) { border-color: var(--accent-primary); background: rgba(16, 185, 129, 0.1); }
        .option.selected { border-color: var(--accent-primary); border-width: 3px; background: rgba(16, 185, 129, 0.2); box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.25), inset 0 0 12px rgba(16, 185, 129, 0.1); }
        .option.correct { border-color: var(--success); background: rgba(34, 197, 94, 0.15); }
        .option.incorrect { border-color: var(--error); background: rgba(239, 68, 68, 0.15); }
        .option.disabled { cursor: default; }
        .option-marker { width: 28px; height: 28px; border-radius: 50%; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; flex-shrink: 0; }
        .option.selected .option-marker { border-color: var(--accent-primary); background: var(--accent-primary); color: white; }
        .option.correct .option-marker { border-color: var(--success); background: var(--success); color: white; }
        .option.incorrect .option-marker { border-color: var(--error); background: var(--error); color: white; }
        .option-text { flex: 1; padding-top: 2px; }
        .explanation { margin-top: 1.5rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; border-left: 4px solid var(--info); display: none; }
        .explanation.show { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .explanation-title { display: flex; align-items: center; gap: 0.5rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--info); }
        .answer-header { font-weight: 600; color: var(--success); margin-bottom: 0.5rem; }
        .explanation-text { color: var(--text-secondary); margin-bottom: 1rem; }
        .doc-link { display: inline-flex; align-items: center; gap: 0.5rem; color: var(--accent-primary); text-decoration: none; font-size: 0.875rem; padding: 0.5rem 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 6px; }
        .doc-link:hover { background: rgba(16, 185, 129, 0.2); }
        .btn-container { display: flex; justify-content: space-between; gap: 1rem; margin-top: 1rem; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
        .btn-primary { background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4); }
        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); }
        .btn-secondary:hover { border-color: var(--accent-primary); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .results-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; text-align: center; border: 1px solid var(--border); display: none; }
        .results-card.show { display: block; animation: fadeIn 0.5s ease; }
        .results-score { font-size: 4rem; font-weight: 700; margin: 1rem 0; }
        .results-score.pass { color: var(--success); } .results-score.fail { color: var(--error); }
        .results-status { font-size: 1.5rem; margin-bottom: 1rem; }
        .results-status.pass { color: var(--success); } .results-status.fail { color: var(--error); }
        .results-details { color: var(--text-secondary); margin-bottom: 2rem; }
        .results-breakdown { display: flex; justify-content: center; gap: 3rem; margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; }
        .breakdown-item { text-align: center; } .breakdown-value { font-size: 2rem; font-weight: 700; } .breakdown-value.correct { color: var(--success); } .breakdown-value.incorrect { color: var(--error); } .breakdown-label { font-size: 0.875rem; color: var(--text-secondary); }
        .hidden { display: none !important; }
        .shuffle-notice { text-align: center; padding: 0.75rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px; margin-bottom: 1.5rem; color: var(--accent-secondary); font-size: 0.875rem; }
        @media (max-width: 640px) { .container { padding: 1rem; } h1 { font-size: 1.5rem; } .stats-bar { gap: 1rem; } .mode-selector, .btn-container, .results-breakdown { flex-direction: column; } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <span class="badge">Domain 5: Data Protection (18%)</span>
            <h1>AWS Key Management Service (KMS)</h1>
            <p class="subtitle">Comprehensive Quiz for AWS Security Specialty (SCS-C03)</p>
            <div class="stats-bar">
                <div class="stat"><div class="stat-value">25</div><div class="stat-label">Questions</div></div>
                <div class="stat"><div class="stat-value">80%</div><div class="stat-label">Pass Score</div></div>
                <div class="stat"><div class="stat-value">62:30</div><div class="stat-label">Exam Time</div></div>
            </div>
        </header>
        <div class="mode-selector" id="modeSelector">
            <button class="mode-btn" onclick="startQuiz('learn')">üìö Learn Mode</button>
            <button class="mode-btn" onclick="startQuiz('exam')">‚è±Ô∏è Exam Mode</button>
        </div>
        <div id="quizContent" class="hidden">
            <div class="progress-container">
                <div class="progress-header">
                    <span class="progress-text">Question <span id="currentQ">1</span> of <span id="totalQ">25</span></span>
                    <span class="timer" id="timer">62:30</span>
                </div>
                <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width: 0%"></div></div>
            </div>
            <div class="shuffle-notice" id="shuffleNotice">üîÄ Questions and options have been randomized</div>
            <div id="questionsContainer"></div>
            <div class="btn-container">
                <button class="btn btn-secondary" id="prevBtn" onclick="navigate(-1)" disabled>‚Üê Previous</button>
                <button class="btn btn-secondary" id="shuffleBtn" onclick="shuffleQuiz()">üîÄ Shuffle</button>
                <button class="btn btn-primary" id="nextBtn" onclick="navigate(1)">Next ‚Üí</button>
            </div>
        </div>
        <div class="results-card" id="resultsCard">
            <h2>Quiz Complete!</h2>
            <div class="results-score" id="scorePercent">0%</div>
            <div class="results-status" id="resultStatus">-</div>
            <p class="results-details" id="resultDetails"></p>
            <div class="results-breakdown">
                <div class="breakdown-item"><div class="breakdown-value correct" id="correctCount">0</div><div class="breakdown-label">Correct</div></div>
                <div class="breakdown-item"><div class="breakdown-value incorrect" id="incorrectCount">0</div><div class="breakdown-label">Incorrect</div></div>
            </div>
            <button class="btn btn-primary" onclick="restartQuiz()">üîÑ Restart Quiz</button>
        </div>
    </div>
    <script>
        const questions = [
            { id: 1, question: "An application uses SSE-S3 for S3 encryption. The security team asks what type of KMS key is being used. What should you tell them?", options: ["A customer managed key created automatically in your account by the S3 service", "An AWS managed key (aws/s3) that appears in your KMS console and is managed by S3", "An AWS owned key managed by AWS across multiple customer accounts, not visible in your console", "No KMS key is used; SSE-S3 uses S3-specific encryption that bypasses KMS entirely"], correct: 3, explanation: "SSE-S3 does NOT use KMS at all. S3 manages encryption keys entirely internally using AES-256, separate from the KMS service. If you need KMS features (CloudTrail key usage logging, key policies, customer managed keys), you must use SSE-KMS instead. The aws/s3 AWS managed key only appears when using SSE-KMS, not SSE-S3.", docLink: "https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingServerSideEncryption.html" },
            { id: 2, question: "A developer tries to encrypt a 10 KB file using the KMS Encrypt API directly and receives an error. Why?", options: ["The Encrypt API requires the file to be base64 encoded first, doubling the effective size limit", "The Encrypt API has a 4 KB limit; use GenerateDataKey for envelope encryption of larger data", "The Encrypt API only works with text data; binary files require the EncryptBinary API instead", "The Encrypt API requires a specific encryption context that wasn't provided with the request"], correct: 1, explanation: "KMS can only directly encrypt up to 4 KB of data with the Encrypt API. For larger data, use envelope encryption: GenerateDataKey to get a data key, encrypt your data locally with that key, then store the encrypted data key alongside.", docLink: "https://docs.aws.amazon.com/kms/latest/APIReference/API_Encrypt.html" },
            { id: 3, question: "An architect describes their encryption approach: 'Generate a data key, use its plaintext to encrypt our files locally, then store the encrypted data key with the ciphertext.' What is this called?", options: ["Key wrapping - where the data key wraps around the encrypted data for protection", "Envelope encryption - using a data key for data and a KMS key to protect the data key", "Hierarchical encryption - creating a key hierarchy with the KMS key at the root", "Dual encryption - encrypting both the key and data separately for defense in depth"], correct: 1, explanation: "Envelope encryption uses a two-tier approach: A data key encrypts your actual data locally (fast, unlimited size), then KMS encrypts that data key with your KMS key (never exceeds 4 KB). Store the encrypted data key with your ciphertext.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html#enveloping" },
            { id: 4, question: "An application stores encrypted data keys for batch processing later. It doesn't need to encrypt data immediately when generating the keys. Which API should it use?", options: ["GenerateDataKey with a flag to suppress the plaintext key from the response", "GenerateDataKeyWithoutPlaintext to receive only the encrypted data key", "GenerateDataKey followed immediately by shredding the plaintext from memory", "CreateDataKey with delayed activation to prevent immediate plaintext access"], correct: 1, explanation: "GenerateDataKeyWithoutPlaintext returns only the encrypted data key, not the plaintext. Use this when you need to store the key for later but don't need to encrypt immediately. Call Decrypt when you're ready to use the key.", docLink: "https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKeyWithoutPlaintext.html" },
            { id: 5, question: "A compliance auditor asks how often KMS automatically rotates customer managed symmetric keys when rotation is enabled. What is the interval?", options: ["Every 90 days (quarterly) to align with common compliance frameworks", "Every 180 days (semi-annually) as a balance between security and operational overhead", "Every 365 days (annually), with old key material retained for decryption", "The rotation interval is configurable from 30 to 365 days based on security requirements"], correct: 2, explanation: "Automatic key rotation for customer managed symmetric keys occurs every 365 days (1 year). KMS creates new cryptographic material but retains ALL previous versions indefinitely, ensuring you can always decrypt old data.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html" },
            { id: 6, question: "A security engineer configures IAM policies to grant kms:Encrypt to a role. The role still can't encrypt with the target KMS key. What might be missing?", options: ["The role also needs kms:GenerateDataKey permission for the encryption to work", "The KMS key policy must also allow the role access; IAM alone is insufficient for KMS", "The role needs to be in the same account as the KMS key for IAM policies to work", "The KMS key must have a key alias configured before IAM policies can reference it"], correct: 1, explanation: "KMS requires key policies for access. Unlike most AWS services, IAM policies ALONE cannot grant KMS access. The key policy must either allow the specific principal OR allow IAM policies to grant permissions (via the 'Enable IAM policies' statement).", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/key-policies.html" },
            { id: 7, question: "A security team needs to give an external contractor's IAM role temporary access to decrypt data with a KMS key for a 2-week audit. They don't want to modify the key policy or create permanent IAM policies. What mechanism should be used?", options: ["Add the contractor's role ARN to the key policy and remove it after the audit", "Create a KMS grant for the contractor's IAM role with Decrypt permission", "Share the key with the contractor's AWS account using Resource Access Manager (RAM)", "Create temporary IAM credentials for the contractor with an expiration date"], correct: 1, explanation: "KMS grants provide temporary, delegated access to specific KMS operations without modifying key policies or IAM policies. Grants can be created for any IAM principal (users, roles) and retired when no longer needed. This is ideal for time-limited access like audits or contractor engagements.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/grants.html" },
            { id: 8, question: "An S3 bucket uses SSE-KMS with encryption context {'bucket': 'prod-data', 'purpose': 'analytics'}. A Lambda tries to decrypt an object but doesn't specify encryption context. What happens?", options: ["Decryption succeeds but the encryption context is logged as empty in CloudTrail", "Decryption fails because the encryption context must match exactly for successful decryption", "Decryption succeeds because encryption context is optional metadata not enforced cryptographically", "Decryption fails with an access denied error rather than a decryption error"], correct: 1, explanation: "Encryption context is cryptographically bound to the ciphertext as additional authenticated data (AAD). You MUST provide the exact same encryption context for decryption - it's not optional metadata but a security control.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html#encrypt_context" },
            { id: 9, question: "A KMS key was accidentally scheduled for deletion 5 days ago (waiting period is 7 days). Can the data encrypted with this key still be recovered?", options: ["No, once deletion is scheduled, the key is immediately disabled and data is unrecoverable", "Yes, cancel the deletion within the waiting period and the key will be restored to active state", "Yes, but only by contacting AWS Support to restore the key before the waiting period expires", "No, but AWS automatically backs up key material so data can be recovered after deletion"], correct: 1, explanation: "During the waiting period (7-30 days), the key is disabled but can be recovered by canceling the deletion. Once the waiting period expires, the key and all data encrypted with it become PERMANENTLY unrecoverable - there are no backups.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys.html" },
            { id: 10, question: "A regulated company must maintain physical control of their HSMs for compliance. They also want to use KMS APIs. What should they implement?", options: ["AWS CloudHSM in single-tenant mode with custom KMS integration through API Gateway", "A Custom Key Store that backs KMS keys with an AWS CloudHSM cluster they control", "On-premises HSM with AWS Direct Connect and custom key import for each KMS operation", "AWS Outposts with dedicated KMS hardware deployed in their data center"], correct: 1, explanation: "A Custom Key Store lets you back KMS keys with an AWS CloudHSM cluster that you control. This provides KMS convenience (APIs, integration) with CloudHSM's dedicated, single-tenant HSMs. Keys never leave the HSM in plaintext.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/custom-key-store-overview.html" },
            { id: 11, question: "A company has key material generated by their on-premises HSM and wants to use it in KMS for regulatory reasons. Which approach is correct?", options: ["Create an AWS managed key and contact AWS Support to upload the key material", "Create a customer managed key with 'External' origin and import the key material", "Create any KMS key and use the ReEncrypt API to transfer the key material from the HSM", "Create a Custom Key Store and synchronize key material from the on-premises HSM"], correct: 1, explanation: "You can import your own key material into customer managed KMS keys by creating a key with 'External' origin. This gives you control over key generation but note: imported keys don't support automatic rotation and you can set an expiration date.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/importing-keys.html" },
            { id: 12, question: "A partner without AWS access needs to send encrypted data that only your application can decrypt. The partner cannot call AWS APIs. Which approach enables this?", options: ["Create a symmetric KMS key and share the key material with the partner for local encryption", "Create an asymmetric KMS key and share the downloadable public key with the partner for encryption", "Create a symmetric KMS key and have the partner use envelope encryption with a shared secret", "Create an asymmetric KMS key and share the private key with the partner for encryption"], correct: 1, explanation: "Asymmetric KMS keys have a public/private key pair. You can download the public key and share it with external parties who don't have AWS access. They encrypt data with the public key (outside AWS), and your application decrypts with the private key via KMS. The private key never leaves KMS.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/symmetric-asymmetric.html" },
            { id: 13, question: "An architect needs to create an asymmetric KMS key for both document signing and message encryption. How should they proceed?", options: ["Create one asymmetric key and specify both SIGN_VERIFY and ENCRYPT_DECRYPT as key usages", "Create two separate asymmetric keys: one for signing and one for encryption", "Create one asymmetric key for signing; use a symmetric key for encryption instead", "Create one asymmetric key for encryption; use AWS Certificate Manager for signing"], correct: 1, explanation: "An asymmetric KMS key can perform EITHER signing/verification OR encryption/decryption, but NOT both. You must create separate keys for each purpose. This enforces separation of duties and follows cryptographic best practices.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/symmetric-asymmetric.html" },
            { id: 14, question: "A security team wants a KMS key to only be usable when called through S3 (not directly via KMS APIs). Which condition key enforces this?", options: ["kms:CallerService with StringEquals condition matching 's3.amazonaws.com'", "kms:ViaService with StringEquals condition matching 's3.region.amazonaws.com'", "aws:SourceService with StringEquals condition matching 's3.amazonaws.com'", "kms:EncryptionContext with a required key identifying S3 as the caller"], correct: 1, explanation: "kms:ViaService restricts key usage to requests from specific AWS services. The format is 'servicename.region.amazonaws.com' (e.g., s3.us-east-1.amazonaws.com). This prevents direct KMS API calls while allowing S3 operations.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/policy-conditions.html#conditions-kms-via-service" },
            { id: 15, question: "A global application needs data encrypted in us-east-1 to be decryptable in eu-west-1 without cross-region API calls. What KMS feature should they use?", options: ["Cross-region key replication that automatically copies the key to all enabled regions", "Multi-Region keys that share key material and can decrypt each other's ciphertext", "Global KMS keys that are accessible from all regions through a global endpoint", "Key aliases that point to different regional keys with synchronized key material"], correct: 1, explanation: "Multi-Region keys are interoperable KMS keys in different regions with the same key material. Data encrypted in one region can be decrypted in another using the related multi-Region key, without cross-region calls. Useful for DR and global apps.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/multi-region-keys-overview.html" },
            { id: 16, question: "A new KMS key is created without specifying a custom key policy. The key creator's IAM role doesn't have any KMS permissions in its identity policy. Can they use the key?", options: ["No, the creator must explicitly grant themselves permissions in the key policy", "Yes, the default policy allows the root user full access and enables IAM policy permissions", "Yes, the key creator automatically gets all permissions through an implicit creator policy", "No, but AWS Support can grant initial access if the creator is locked out"], correct: 1, explanation: "The default key policy allows the AWS account (root user) full access and enables IAM policies to grant permissions. This prevents lockout and allows flexible permission management. The creator doesn't automatically get permissions unless granted.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/key-policies.html#key-policy-default" },
            { id: 17, question: "An application references KMS keys by ARN. A key needs to be rotated manually to new key material. How can this be done without updating the application?", options: ["Enable automatic rotation which replaces the key ARN transparently", "Use a key alias; update the alias to point to the new key without changing the ARN reference", "Import new key material into the existing key, which doesn't change the key ID or ARN", "Create the new key with the same key ID as the old key to maintain the same ARN"], correct: 1, explanation: "Key aliases are friendly names (alias/my-key) that point to KMS keys. Update the alias to point to a different key without changing application code. Note: if using ARNs directly, you'd need to update to use alias ARNs instead.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/kms-alias.html" },
            { id: 18, question: "A security team needs to audit all uses of a specific KMS key, including what data was associated with each encryption. What should they review?", options: ["KMS key metrics in CloudWatch, which include encryption context as a dimension", "CloudTrail logs, which record all KMS API calls including encryption context", "AWS Config rules that track KMS key usage and associated resource configurations", "KMS access logs in S3, similar to S3 server access logging for buckets"], correct: 1, explanation: "KMS logs ALL API calls to CloudTrail, including key ID, encryption context (if provided), caller identity, and timestamps. Encryption context is visible in logs (it's not secret), making it invaluable for audit trails.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/logging-using-cloudtrail.html" },
            { id: 19, question: "An AWS service receives a KMS grant to use a key. The security team wants to ensure the service can only operate on resources with a specific tag. What grant feature enables this?", options: ["Grant constraints with tag conditions specifying required resource tags", "Grant constraints requiring specific encryption context that includes the tag value", "Grant scope that limits operations to resources matching a tag-based ARN pattern", "Grant policies that attach IAM-style tag conditions to the grant permissions"], correct: 1, explanation: "Grant constraints like EncryptionContextEquals require specific encryption context values for operations. By requiring the tag value in the encryption context, you ensure operations only work for properly tagged resources (assuming the tag is included in context).", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/grant-manage.html" },
            { id: 20, question: "A customer managed KMS key has automatic rotation disabled. The security team wants to enable it. What must they verify first?", options: ["The key must have at least one key alias configured before rotation can be enabled", "The key must use KMS-generated key material, not imported key material", "The key must have been created within the last 365 days to support rotation", "The key must be in the same region as the primary CloudTrail trail for audit logging"], correct: 1, explanation: "Automatic rotation is only supported for symmetric keys with KMS-generated key material. Imported key material, asymmetric keys, keys in Custom Key Stores, and HMAC keys don't support automatic rotation - you must rotate them manually.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html#rotating-keys-enable-disable" },
            { id: 21, question: "An application needs to migrate encrypted data from one KMS key to another without ever exposing plaintext to the application. Which API should be used?", options: ["Decrypt with the old key then Encrypt with the new key in a single atomic transaction", "ReEncrypt to decrypt under the source key and re-encrypt under the destination key within KMS", "GenerateDataKey with the new key to create new data keys for re-encryption", "CopyEncryptedData API that handles key migration transparently in KMS"], correct: 1, explanation: "ReEncrypt decrypts ciphertext under one key and re-encrypts it under another key entirely within KMS. The plaintext is never exposed to the caller, making it ideal for key migration or changing encryption contexts securely.", docLink: "https://docs.aws.amazon.com/kms/latest/APIReference/API_ReEncrypt.html" },
            { id: 22, question: "An administrator schedules a KMS key for deletion with a 7-day waiting period. On day 4, they realize the key is still needed. What can they do?", options: ["Nothing - once scheduled, deletion cannot be canceled and the key is already disabled", "Contact AWS Support to expedite restoration before the 7-day period expires", "Cancel the scheduled deletion; the key returns to disabled state and can be re-enabled", "Restore the key from the automatic backup that KMS creates before scheduling deletion"], correct: 2, explanation: "During the waiting period (7-30 days), you can cancel deletion. The key returns to disabled state - you must explicitly enable it to use it again. After the waiting period, deletion is permanent with no recovery option.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys.html" },
            { id: 23, question: "A key policy allows cross-account access to Account B. The security team wants to restrict access to only specific roles in Account B. Which condition key helps?", options: ["kms:PrincipalOrgID to verify the caller is in the same AWS Organization", "kms:CallerAccount combined with aws:PrincipalArn to restrict to specific roles in that account", "kms:CrossAccountAccess to enable fine-grained cross-account permission controls", "aws:SourceAccount to verify which account is making the KMS API request"], correct: 1, explanation: "Use kms:CallerAccount to verify the caller's account, and combine with aws:PrincipalArn conditions to restrict to specific roles. This provides fine-grained cross-account access control beyond just allowing the entire account.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/policy-conditions.html#conditions-kms-caller-account" },
            { id: 24, question: "A partner needs to encrypt data that only your AWS application can decrypt. They don't have AWS access. How can this be achieved with KMS?", options: ["Share your KMS key ID with them so they can call the KMS Encrypt API directly", "Create an asymmetric key and give them the downloadable public key for encryption", "Create a symmetric key and export the key material for them to use locally", "Set up a VPN connection so they can securely access your KMS endpoint"], correct: 1, explanation: "You can download the public key of an asymmetric KMS key and share it with external parties. They encrypt data with the public key (no AWS access needed), and you decrypt with the private key via KMS (never leaves KMS).", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/download-public-key.html" },
            { id: 25, question: "An application needs to ensure message integrity without encryption. The messages should be verified as authentic and unmodified. Which KMS key type should be used?", options: ["Symmetric encryption key with encryption context containing a hash of the message", "Asymmetric signing key to sign messages and distribute the public key for verification", "HMAC key to generate and verify message authentication codes for integrity", "Any KMS key type works since all encryption implicitly provides integrity verification"], correct: 2, explanation: "KMS HMAC keys generate and verify Hash-based Message Authentication Codes. They ensure message integrity and authenticity without encryption. Both GenerateMac and VerifyMac happen entirely within KMS. Asymmetric signing would also work but HMAC is simpler for this use case.", docLink: "https://docs.aws.amazon.com/kms/latest/developerguide/hmac.html" }
        ];

        let currentMode = 'learn', currentQuestion = 0, userAnswers = [], answersRevealed = [], shuffledQuestions = [], timerInterval = null, timeRemaining = 0;
        function shuffleArray(a) { const b = [...a]; for (let i = b.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [b[i], b[j]] = [b[j], b[i]]; } return b; }
        function shuffleQuestionOptions(q) { const idx = shuffleArray([0,1,2,3]); return { ...q, options: idx.map(i => q.options[i]), correct: idx.indexOf(q.correct) }; }
        function startQuiz(mode) { currentMode = mode; currentQuestion = 0; userAnswers = new Array(questions.length).fill(null); answersRevealed = new Array(questions.length).fill(false); shuffledQuestions = shuffleArray(questions).map(shuffleQuestionOptions); document.getElementById('modeSelector').classList.add('hidden'); document.getElementById('quizContent').classList.remove('hidden'); document.getElementById('resultsCard').classList.remove('show'); document.getElementById('totalQ').textContent = shuffledQuestions.length; if (mode === 'exam') { timeRemaining = shuffledQuestions.length * 150; startTimer(); document.getElementById('shuffleBtn').classList.add('hidden'); } else { document.getElementById('timer').textContent = 'Learn Mode'; document.getElementById('shuffleBtn').classList.remove('hidden'); } renderQuestion(); }
        function startTimer() { updateTimerDisplay(); timerInterval = setInterval(() => { timeRemaining--; updateTimerDisplay(); if (timeRemaining <= 0) { clearInterval(timerInterval); showResults(); } }, 1000); }
        function updateTimerDisplay() { const m = Math.floor(timeRemaining / 60), s = timeRemaining % 60, el = document.getElementById('timer'); el.textContent = `${m}:${s.toString().padStart(2, '0')}`; el.classList.remove('warning', 'danger'); if (timeRemaining <= 60) el.classList.add('danger'); else if (timeRemaining <= 300) el.classList.add('warning'); }
        function renderQuestion() { const q = shuffledQuestions[currentQuestion], letters = ['A','B','C','D'], ans = userAnswers[currentQuestion], revealed = answersRevealed[currentQuestion]; let opts = q.options.map((o, i) => { let c = 'option'; if (currentMode === 'learn' && revealed) { c += ' disabled'; if (i === q.correct) c += ' correct'; else if (i === ans && ans !== q.correct) c += ' incorrect'; } else if (ans === i) c += ' selected'; return `<div class="${c}" onclick="selectOption(${i})"><span class="option-marker">${letters[i]}</span><span class="option-text">${o}</span></div>`; }).join(''); let exp = currentMode === 'learn' ? `<div class="explanation ${revealed ? 'show' : ''}"><div class="explanation-title">üìñ Explanation</div><div class="answer-header">Correct Answer: ${letters[q.correct]}</div><p class="explanation-text">${q.explanation}</p><a href="${q.docLink}" target="_blank" class="doc-link">üìÑ View AWS Documentation ‚Üí</a></div>` : ''; document.getElementById('questionsContainer').innerHTML = `<div class="question-card"><div class="question-header"><span class="question-number">Question ${currentQuestion + 1}</span><span class="question-domain">KMS</span></div><p class="question-text">${q.question}</p><div class="options">${opts}</div>${currentMode === 'learn' && !revealed ? '<button class="btn btn-primary" style="margin-top:1rem;width:100%;" onclick="revealAnswer()">Show Answer</button>' : ''}${exp}</div>`; document.getElementById('currentQ').textContent = currentQuestion + 1; document.getElementById('progressFill').style.width = `${((currentQuestion + 1) / shuffledQuestions.length) * 100}%`; document.getElementById('prevBtn').disabled = currentQuestion === 0; document.getElementById('nextBtn').textContent = currentQuestion === shuffledQuestions.length - 1 ? (currentMode === 'exam' ? 'Submit Quiz' : 'See Results') : 'Next ‚Üí'; }
        function selectOption(i) { if (currentMode === 'learn' && answersRevealed[currentQuestion]) return; userAnswers[currentQuestion] = i; renderQuestion(); }
        function revealAnswer() { if (userAnswers[currentQuestion] === null) userAnswers[currentQuestion] = -1; answersRevealed[currentQuestion] = true; renderQuestion(); }
        function navigate(d) { if (d === 1 && currentQuestion === shuffledQuestions.length - 1) { showResults(); return; } currentQuestion = Math.max(0, Math.min(currentQuestion + d, shuffledQuestions.length - 1)); renderQuestion(); }
        function shuffleQuiz() { if (currentMode !== 'learn') return; currentQuestion = 0; userAnswers = new Array(questions.length).fill(null); answersRevealed = new Array(questions.length).fill(false); shuffledQuestions = shuffleArray(questions).map(shuffleQuestionOptions); renderQuestion(); }
        function showResults() { if (timerInterval) clearInterval(timerInterval); let correct = shuffledQuestions.reduce((c, q, i) => c + (userAnswers[i] === q.correct ? 1 : 0), 0); const total = shuffledQuestions.length, pct = Math.round((correct / total) * 100), pass = pct >= 80; document.getElementById('quizContent').classList.add('hidden'); document.getElementById('resultsCard').classList.add('show'); document.getElementById('scorePercent').textContent = pct + '%'; document.getElementById('scorePercent').className = 'results-score ' + (pass ? 'pass' : 'fail'); document.getElementById('resultStatus').textContent = pass ? 'üéâ PASSED!' : 'üìö Keep Studying'; document.getElementById('resultStatus').className = 'results-status ' + (pass ? 'pass' : 'fail'); document.getElementById('resultDetails').textContent = `You answered ${correct} out of ${total} questions correctly.`; document.getElementById('correctCount').textContent = correct; document.getElementById('incorrectCount').textContent = total - correct; }
        function restartQuiz() { document.getElementById('resultsCard').classList.remove('show'); document.getElementById('modeSelector').classList.remove('hidden'); document.getElementById('quizContent').classList.add('hidden'); if (timerInterval) clearInterval(timerInterval); }
    </script>
</body>
</html>
