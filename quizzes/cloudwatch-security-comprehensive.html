<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amazon CloudWatch Security Monitoring Quiz | AWS Security Specialty (SCS-C03)</title>
    <style>
        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #141b2d;
            --bg-tertiary: #1a2236;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --accent-primary: #ec4899;
            --accent-secondary: #f472b6;
            --success: #22c55e;
            --error: #ef4444;
            --warning: #eab308;
            --info: #3b82f6;
            --border: #2d3a52;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg-primary); color: var(--text-primary); line-height: 1.6; min-height: 100vh; }
        .container { max-width: 900px; margin: 0 auto; padding: 2rem; }
        header { text-align: center; margin-bottom: 2rem; padding: 2rem; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%); border-radius: 16px; border: 1px solid var(--border); }
        .badge { display: inline-block; background: var(--accent-primary); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; margin-bottom: 1rem; text-transform: uppercase; }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .subtitle { color: var(--text-secondary); font-size: 1rem; }
        .stats-bar { display: flex; justify-content: center; gap: 2rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border); }
        .stat { text-align: center; }
        .stat-value { font-size: 1.5rem; font-weight: 700; color: var(--accent-primary); }
        .stat-label { font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; }
        .mode-selector { display: flex; gap: 1rem; justify-content: center; margin-bottom: 2rem; }
        .mode-btn { padding: 0.75rem 2rem; border: 2px solid var(--border); background: var(--bg-secondary); color: var(--text-primary); border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease; }
        .mode-btn:hover { border-color: var(--accent-primary); background: var(--bg-tertiary); }
        .progress-container { background: var(--bg-secondary); border-radius: 12px; padding: 1rem 1.5rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
        .progress-text { font-size: 0.875rem; color: var(--text-secondary); }
        .timer { font-size: 1.25rem; font-weight: 600; color: var(--accent-primary); font-family: 'Consolas', monospace; }
        .timer.warning { color: var(--warning); animation: pulse 1s infinite; }
        .timer.danger { color: var(--error); animation: pulse 0.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .progress-bar { height: 8px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary)); border-radius: 4px; transition: width 0.3s ease; }
        .question-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .question-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
        .question-number { background: var(--bg-tertiary); color: var(--accent-primary); padding: 0.25rem 0.75rem; border-radius: 6px; font-size: 0.875rem; font-weight: 600; }
        .question-domain { font-size: 0.75rem; color: var(--text-secondary); background: var(--bg-tertiary); padding: 0.25rem 0.5rem; border-radius: 4px; }
        .question-text { font-size: 1.125rem; margin-bottom: 1.5rem; line-height: 1.7; }
        .options { display: flex; flex-direction: column; gap: 0.75rem; }
        .option { display: flex; align-items: flex-start; gap: 1rem; padding: 1rem; background: var(--bg-tertiary); border: 2px solid var(--border); border-radius: 10px; cursor: pointer; transition: all 0.2s ease; }
        .option:hover:not(.disabled) { border-color: var(--accent-primary); background: rgba(236, 72, 153, 0.1); }
        .option.selected { border-color: var(--accent-primary); background: rgba(236, 72, 153, 0.15); }
        .option.correct { border-color: var(--success); background: rgba(34, 197, 94, 0.15); }
        .option.incorrect { border-color: var(--error); background: rgba(239, 68, 68, 0.15); }
        .option.disabled { cursor: default; }
        .option-marker { width: 28px; height: 28px; border-radius: 50%; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; flex-shrink: 0; transition: all 0.2s ease; }
        .option.selected .option-marker { border-color: var(--accent-primary); background: var(--accent-primary); color: white; }
        .option.correct .option-marker { border-color: var(--success); background: var(--success); color: white; }
        .option.incorrect .option-marker { border-color: var(--error); background: var(--error); color: white; }
        .option-text { flex: 1; padding-top: 2px; }
        .explanation { margin-top: 1.5rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; border-left: 4px solid var(--info); display: none; }
        .explanation.show { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .explanation-title { display: flex; align-items: center; gap: 0.5rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--info); }
        .answer-header { font-weight: 600; color: var(--success); margin-bottom: 0.5rem; }
        .explanation-text { color: var(--text-secondary); margin-bottom: 1rem; }
        .doc-link { display: inline-flex; align-items: center; gap: 0.5rem; color: var(--accent-primary); text-decoration: none; font-size: 0.875rem; padding: 0.5rem 1rem; background: rgba(236, 72, 153, 0.1); border-radius: 6px; transition: background 0.2s ease; }
        .doc-link:hover { background: rgba(236, 72, 153, 0.2); }
        .btn-container { display: flex; justify-content: space-between; gap: 1rem; margin-top: 1rem; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
        .btn-primary { background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(236, 72, 153, 0.4); }
        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); }
        .btn-secondary:hover { border-color: var(--accent-primary); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .results-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; text-align: center; border: 1px solid var(--border); display: none; }
        .results-card.show { display: block; animation: fadeIn 0.5s ease; }
        .results-score { font-size: 4rem; font-weight: 700; margin: 1rem 0; }
        .results-score.pass { color: var(--success); }
        .results-score.fail { color: var(--error); }
        .results-status { font-size: 1.5rem; margin-bottom: 1rem; }
        .results-status.pass { color: var(--success); }
        .results-status.fail { color: var(--error); }
        .results-details { color: var(--text-secondary); margin-bottom: 2rem; }
        .results-breakdown { display: flex; justify-content: center; gap: 3rem; margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; }
        .breakdown-item { text-align: center; }
        .breakdown-value { font-size: 2rem; font-weight: 700; }
        .breakdown-value.correct { color: var(--success); }
        .breakdown-value.incorrect { color: var(--error); }
        .breakdown-label { font-size: 0.875rem; color: var(--text-secondary); }
        .hidden { display: none !important; }
        .shuffle-notice { text-align: center; padding: 0.75rem; background: rgba(236, 72, 153, 0.1); border-radius: 8px; margin-bottom: 1.5rem; color: var(--accent-secondary); font-size: 0.875rem; }
        @media (max-width: 640px) { .container { padding: 1rem; } h1 { font-size: 1.5rem; } .stats-bar { gap: 1rem; } .mode-selector { flex-direction: column; } .btn-container { flex-direction: column; } .results-breakdown { flex-direction: column; gap: 1.5rem; } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <span class="badge">Domain 1: Detection</span>
            <h1>üìä Amazon CloudWatch Security</h1>
            <p class="subtitle">Comprehensive Quiz for AWS Security Specialty (SCS-C03)</p>
            <div class="stats-bar">
                <div class="stat"><div class="stat-value">20</div><div class="stat-label">Questions</div></div>
                <div class="stat"><div class="stat-value">80%</div><div class="stat-label">Pass Score</div></div>
                <div class="stat"><div class="stat-value">50:00</div><div class="stat-label">Exam Time</div></div>
            </div>
        </header>
        <div class="mode-selector" id="modeSelector">
            <button class="mode-btn" onclick="startQuiz('learn')">üìö Learn Mode</button>
            <button class="mode-btn" onclick="startQuiz('exam')">‚è±Ô∏è Exam Mode</button>
        </div>
        <div id="quizContent" class="hidden">
            <div class="progress-container">
                <div class="progress-header">
                    <span class="progress-text">Question <span id="currentQ">1</span> of <span id="totalQ">20</span></span>
                    <span class="timer" id="timer">50:00</span>
                </div>
                <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width: 0%"></div></div>
            </div>
            <div class="shuffle-notice" id="shuffleNotice">üîÄ Questions and options have been randomized</div>
            <div id="questionsContainer"></div>
            <div class="btn-container">
                <button class="btn btn-secondary" id="prevBtn" onclick="navigate(-1)" disabled>‚Üê Previous</button>
                <button class="btn btn-secondary" id="shuffleBtn" onclick="shuffleQuiz()">üîÄ Shuffle</button>
                <button class="btn btn-primary" id="nextBtn" onclick="navigate(1)">Next ‚Üí</button>
            </div>
        </div>
        <div class="results-card" id="resultsCard">
            <h2>Quiz Complete!</h2>
            <div class="results-score" id="scorePercent">0%</div>
            <div class="results-status" id="resultStatus">-</div>
            <p class="results-details" id="resultDetails"></p>
            <div class="results-breakdown">
                <div class="breakdown-item"><div class="breakdown-value correct" id="correctCount">0</div><div class="breakdown-label">Correct</div></div>
                <div class="breakdown-item"><div class="breakdown-value incorrect" id="incorrectCount">0</div><div class="breakdown-label">Incorrect</div></div>
            </div>
            <button class="btn btn-primary" onclick="restartQuiz()">üîÑ Restart Quiz</button>
        </div>
    </div>
    <script>
        const questions = [
            {
                id: 1,
                question: "What is the primary security-related use of Amazon CloudWatch for the AWS Security Specialty exam?",
                options: [
                    "Blocking malicious traffic",
                    "Monitoring, alerting, and detecting security anomalies through logs, metrics, and alarms",
                    "Encrypting data at rest",
                    "Managing IAM policies"
                ],
                correct: 1,
                explanation: "CloudWatch is essential for security monitoring, alerting, and detection. It collects logs and metrics from AWS resources, allows you to set alarms for security thresholds, and integrates with other services to enable automated responses to security events.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/WhatIsCloudWatch.html"
            },
            {
                id: 2,
                question: "What is a CloudWatch metric filter used for in security monitoring?",
                options: [
                    "Blocking specific log entries",
                    "Extracting metric data from log events to create alarms",
                    "Encrypting log data",
                    "Deleting old log entries"
                ],
                correct: 1,
                explanation: "Metric filters extract metric data from log events based on patterns you define. For security, you can create metric filters to count specific events like failed login attempts, unauthorized API calls, or security group changes, then set alarms on these metrics.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/MonitoringLogData.html"
            },
            {
                id: 3,
                question: "What is the default retention period for CloudWatch Logs?",
                options: [
                    "7 days",
                    "30 days",
                    "Never expires (indefinite)",
                    "90 days"
                ],
                correct: 2,
                explanation: "By default, CloudWatch Logs are stored indefinitely and never expire. You can configure a retention policy for each log group to automatically delete logs after a specified period (1 day to 10 years) to manage costs and compliance requirements.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/Working-with-log-groups-and-streams.html"
            },
            {
                id: 4,
                question: "Which CloudWatch feature allows you to detect anomalies in metric patterns?",
                options: [
                    "CloudWatch Alarms",
                    "CloudWatch Anomaly Detection",
                    "CloudWatch Insights",
                    "CloudWatch Dashboards"
                ],
                correct: 1,
                explanation: "CloudWatch Anomaly Detection uses machine learning to analyze metric data and create a model of expected values. It can then detect when metrics deviate from normal patterns, which is valuable for identifying unusual security-related activity.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Anomaly_Detection.html"
            },
            {
                id: 5,
                question: "What is CloudWatch Logs Insights used for?",
                options: [
                    "Creating visual dashboards",
                    "Interactively searching and analyzing log data using a query language",
                    "Sending notifications when logs exceed a threshold",
                    "Encrypting log data"
                ],
                correct: 1,
                explanation: "CloudWatch Logs Insights enables you to interactively search and analyze log data using a purpose-built query language. It's useful for security investigations, allowing you to quickly query across multiple log groups to find specific events or patterns.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/AnalyzingLogData.html"
            },
            {
                id: 6,
                question: "How can CloudWatch Alarms trigger automated security responses?",
                options: [
                    "By directly modifying security groups",
                    "Through integration with Amazon SNS, Lambda, or EC2 Auto Scaling actions",
                    "By automatically blocking IP addresses",
                    "By updating IAM policies"
                ],
                correct: 1,
                explanation: "CloudWatch Alarms can trigger automated responses through SNS notifications (which can invoke Lambda functions), EC2 actions, or Auto Scaling policies. For security, you can use Lambda functions to automatically remediate issues or alert security teams.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/AlarmThatSendsEmail.html"
            },
            {
                id: 7,
                question: "What type of CloudWatch alarm monitors a single metric?",
                options: [
                    "Composite alarm",
                    "Metric alarm",
                    "Simple alarm",
                    "Basic alarm"
                ],
                correct: 1,
                explanation: "A metric alarm watches a single CloudWatch metric and performs one or more actions based on the value of the metric relative to a threshold. Composite alarms, in contrast, consider the states of multiple other alarms.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/AlarmThatSendsEmail.html"
            },
            {
                id: 8,
                question: "What is a CloudWatch composite alarm?",
                options: [
                    "An alarm that monitors multiple AWS Regions",
                    "An alarm that combines the states of multiple alarms using Boolean logic",
                    "An alarm that creates compound metrics",
                    "An alarm that runs on multiple schedules"
                ],
                correct: 1,
                explanation: "A composite alarm considers the states of multiple other alarms (metric or composite) using Boolean logic (AND, OR, NOT). This helps reduce alarm noise and creates sophisticated alerting strategies where you only get notified when multiple conditions are met.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Create_Composite_Alarm.html"
            },
            {
                id: 9,
                question: "Which CloudWatch feature can mask sensitive data in logs?",
                options: [
                    "Log encryption",
                    "Data protection policies",
                    "Metric filters",
                    "Subscription filters"
                ],
                correct: 1,
                explanation: "CloudWatch Logs data protection policies allow you to define patterns for sensitive data (like credit card numbers, SSN, etc.) that should be masked or redacted in logs. This helps maintain compliance while still capturing log data for analysis.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/mask-sensitive-log-data.html"
            },
            {
                id: 10,
                question: "What is the CloudWatch agent used for?",
                options: [
                    "Blocking malicious traffic on EC2",
                    "Collecting metrics and logs from EC2 instances and on-premises servers",
                    "Managing CloudWatch alarms",
                    "Creating CloudWatch dashboards"
                ],
                correct: 1,
                explanation: "The CloudWatch agent collects system-level metrics (CPU, memory, disk) and application logs from EC2 instances and on-premises servers. It provides more detailed metrics than the default CloudWatch monitoring and enables log collection from custom applications.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Install-CloudWatch-Agent.html"
            },
            {
                id: 11,
                question: "How can you send CloudWatch Logs to external systems for analysis?",
                options: [
                    "Using S3 export only",
                    "Using subscription filters to stream logs to Lambda, Kinesis, or Firehose",
                    "CloudWatch Logs cannot be exported",
                    "Only through manual download"
                ],
                correct: 1,
                explanation: "Subscription filters allow you to stream CloudWatch Logs in real-time to destinations like Lambda, Kinesis Data Streams, or Kinesis Data Firehose. This enables integration with SIEM systems, custom analytics, or other external security tools.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/SubscriptionFilters.html"
            },
            {
                id: 12,
                question: "What does a CloudWatch alarm state of 'INSUFFICIENT_DATA' indicate?",
                options: [
                    "The alarm is in an error state",
                    "Not enough data points are available to determine the alarm state",
                    "The metric has been deleted",
                    "The alarm has been disabled"
                ],
                correct: 1,
                explanation: "INSUFFICIENT_DATA means the alarm has just started, the metric is not available, or not enough data points are available to determine the alarm state. The other states are OK (within threshold) and ALARM (threshold exceeded).",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/AlarmThatSendsEmail.html"
            },
            {
                id: 13,
                question: "Which security-related metrics can you monitor with VPC Flow Logs in CloudWatch?",
                options: [
                    "IAM policy changes",
                    "Network traffic patterns, rejected connections, and traffic to/from specific IPs",
                    "S3 bucket access patterns",
                    "Lambda function errors"
                ],
                correct: 1,
                explanation: "VPC Flow Logs capture network traffic metadata that can be sent to CloudWatch Logs. You can monitor accepted/rejected connections, traffic patterns, unusual data transfers, and connections to/from known malicious IPs for security analysis.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html"
            },
            {
                id: 14,
                question: "What is cross-account log data sharing in CloudWatch?",
                options: [
                    "Copying logs between accounts manually",
                    "Using subscription filters to share logs from one account to destinations in another",
                    "Merging log groups from different accounts",
                    "Cross-account sharing is not supported"
                ],
                correct: 1,
                explanation: "Cross-account log data sharing allows you to use subscription filters to stream logs from one AWS account to destinations (Lambda, Kinesis) in another account. This enables centralized security log analysis in a dedicated security account.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/CrossAccountSubscriptions.html"
            },
            {
                id: 15,
                question: "What is the purpose of CloudWatch Contributor Insights?",
                options: [
                    "Identifying top contributors to system performance issues",
                    "Analyzing time-series data to identify top-N contributors from log data",
                    "Showing which IAM users are contributing logs",
                    "Tracking cost contributors"
                ],
                correct: 1,
                explanation: "CloudWatch Contributor Insights analyzes time-series data to create reports showing the top-N contributors. For security, you can identify top IP addresses making requests, top error generators, or top users/resources associated with specific events.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContributorInsights.html"
            },
            {
                id: 16,
                question: "How can you encrypt CloudWatch Logs data at rest?",
                options: [
                    "Encryption is not available for CloudWatch Logs",
                    "Using AWS KMS customer managed keys (CMK) associated with log groups",
                    "Only with S3 default encryption",
                    "Encryption is automatic and cannot be configured"
                ],
                correct: 1,
                explanation: "You can encrypt CloudWatch Logs data at rest using AWS KMS customer managed keys. You associate a KMS key with a log group, and all log data stored in that group is encrypted. This provides additional control over who can decrypt the logs.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html"
            },
            {
                id: 17,
                question: "What is the recommended approach for monitoring root account activity using CloudWatch?",
                options: [
                    "Root account activity cannot be monitored",
                    "Create a metric filter on CloudTrail logs for root user activity and set an alarm",
                    "Use CloudWatch RUM",
                    "Monitor the AWS console login page"
                ],
                correct: 1,
                explanation: "Best practice is to send CloudTrail logs to CloudWatch Logs, create a metric filter to detect root account activity (filtering for userIdentity.type = Root), and set a CloudWatch alarm to notify security teams when the root account is used.",
                docLink: "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            },
            {
                id: 18,
                question: "What is a CloudWatch dashboard?",
                options: [
                    "A pre-built security assessment report",
                    "A customizable display of metrics, logs, and alarms for monitoring",
                    "An automated remediation tool",
                    "A log aggregation service"
                ],
                correct: 1,
                explanation: "CloudWatch dashboards are customizable home pages in the CloudWatch console that you can use to monitor resources in a single view. You can create security-focused dashboards showing key metrics, alarm states, and log insights across multiple accounts and Regions.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Dashboards.html"
            },
            {
                id: 19,
                question: "How long is CloudWatch metric data retained?",
                options: [
                    "90 days for all metrics",
                    "Data points with 1-minute resolution are retained for 15 days; aggregated data up to 15 months",
                    "30 days for all data",
                    "Indefinitely like CloudWatch Logs"
                ],
                correct: 1,
                explanation: "CloudWatch retains metric data with different resolutions for different periods: 1-minute data for 15 days, 5-minute data for 63 days, and 1-hour data for 455 days (15 months). Understanding this helps with security forensics and compliance requirements.",
                docLink: "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/cloudwatch_concepts.html"
            },
            {
                id: 20,
                question: "Which CloudWatch feature helps create alerts for security group changes?",
                options: [
                    "CloudWatch Synthetics",
                    "CloudWatch Events/EventBridge integration with CloudTrail for API call monitoring",
                    "CloudWatch RUM",
                    "CloudWatch ServiceLens"
                ],
                correct: 1,
                explanation: "You can use CloudWatch Events (now Amazon EventBridge) integrated with CloudTrail to create rules that trigger when specific API calls occur, like security group modifications (AuthorizeSecurityGroupIngress, RevokeSecurityGroupIngress). This enables real-time alerting on security-sensitive changes.",
                docLink: "https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-ct-events.html"
            }
        ];

        let currentMode = 'learn';
        let currentQuestion = 0;
        let userAnswers = [];
        let shuffledQuestions = [];
        let timerInterval = null;
        let timeRemaining = 0;

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function shuffleQuestionOptions(question) {
            const optionIndices = [0, 1, 2, 3];
            const shuffledIndices = shuffleArray(optionIndices);
            const newQuestion = { ...question };
            newQuestion.options = shuffledIndices.map(i => question.options[i]);
            newQuestion.correct = shuffledIndices.indexOf(question.correct);
            return newQuestion;
        }

        function startQuiz(mode) {
            currentMode = mode;
            currentQuestion = 0;
            userAnswers = new Array(questions.length).fill(null);
            shuffledQuestions = shuffleArray(questions).map(q => shuffleQuestionOptions(q));
            document.getElementById('modeSelector').classList.add('hidden');
            document.getElementById('quizContent').classList.remove('hidden');
            document.getElementById('resultsCard').classList.remove('show');
            document.getElementById('totalQ').textContent = shuffledQuestions.length;
            if (mode === 'exam') {
                timeRemaining = shuffledQuestions.length * 150;
                startTimer();
                document.getElementById('shuffleBtn').classList.add('hidden');
            } else {
                document.getElementById('timer').textContent = 'Learn Mode';
                document.getElementById('shuffleBtn').classList.remove('hidden');
            }
            renderQuestion();
        }

        function startTimer() {
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                if (timeRemaining <= 0) { clearInterval(timerInterval); showResults(); }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const timerEl = document.getElementById('timer');
            timerEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            timerEl.classList.remove('warning', 'danger');
            if (timeRemaining <= 60) timerEl.classList.add('danger');
            else if (timeRemaining <= 300) timerEl.classList.add('warning');
        }

        function renderQuestion() {
            const q = shuffledQuestions[currentQuestion];
            const container = document.getElementById('questionsContainer');
            const letters = ['A', 'B', 'C', 'D'];
            const userAnswer = userAnswers[currentQuestion];
            let optionsHtml = q.options.map((opt, idx) => {
                let classes = 'option';
                if (currentMode === 'learn' && userAnswer !== null) {
                    classes += ' disabled';
                    if (idx === q.correct) classes += ' correct';
                    else if (idx === userAnswer) classes += ' incorrect';
                } else if (userAnswer === idx) classes += ' selected';
                return `<div class="${classes}" onclick="selectOption(${idx})"><span class="option-marker">${letters[idx]}</span><span class="option-text">${opt}</span></div>`;
            }).join('');
            let explanationHtml = '';
            if (currentMode === 'learn') {
                explanationHtml = `<div class="explanation ${userAnswer !== null ? 'show' : ''}" id="explanation"><div class="explanation-title">üìñ Explanation</div><div class="answer-header">Correct Answer: ${letters[q.correct]}</div><p class="explanation-text">${q.explanation}</p><a href="${q.docLink}" target="_blank" class="doc-link">üìÑ View AWS Documentation ‚Üí</a></div>`;
            }
            container.innerHTML = `<div class="question-card"><div class="question-header"><span class="question-number">Question ${currentQuestion + 1}</span><span class="question-domain">CloudWatch</span></div><p class="question-text">${q.question}</p><div class="options">${optionsHtml}</div>${currentMode === 'learn' && userAnswer === null ? '<button class="btn btn-primary" style="margin-top: 1rem; width: 100%;" onclick="revealAnswer()">Show Answer</button>' : ''}${explanationHtml}</div>`;
            document.getElementById('currentQ').textContent = currentQuestion + 1;
            document.getElementById('progressFill').style.width = `${((currentQuestion + 1) / shuffledQuestions.length) * 100}%`;
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            const nextBtn = document.getElementById('nextBtn');
            nextBtn.textContent = currentQuestion === shuffledQuestions.length - 1 ? (currentMode === 'exam' ? 'Submit Quiz' : 'See Results') : 'Next ‚Üí';
        }

        function selectOption(idx) {
            if (currentMode === 'learn' && userAnswers[currentQuestion] !== null) return;
            userAnswers[currentQuestion] = idx;
            if (currentMode === 'exam') renderQuestion();
        }

        function revealAnswer() {
            if (userAnswers[currentQuestion] === null) userAnswers[currentQuestion] = -1;
            renderQuestion();
        }

        function navigate(direction) {
            if (direction === 1 && currentQuestion === shuffledQuestions.length - 1) { showResults(); return; }
            currentQuestion += direction;
            currentQuestion = Math.max(0, Math.min(currentQuestion, shuffledQuestions.length - 1));
            renderQuestion();
        }

        function shuffleQuiz() {
            if (currentMode !== 'learn') return;
            currentQuestion = 0;
            userAnswers = new Array(questions.length).fill(null);
            shuffledQuestions = shuffleArray(questions).map(q => shuffleQuestionOptions(q));
            renderQuestion();
        }

        function showResults() {
            if (timerInterval) clearInterval(timerInterval);
            let correct = 0;
            shuffledQuestions.forEach((q, idx) => { if (userAnswers[idx] !== null && userAnswers[idx] !== -1 && userAnswers[idx] === q.correct) correct++; });
            const total = shuffledQuestions.length;
            const percentage = Math.round((correct / total) * 100);
            const passed = percentage >= 80;
            document.getElementById('quizContent').classList.add('hidden');
            document.getElementById('resultsCard').classList.add('show');
            const scoreEl = document.getElementById('scorePercent');
            scoreEl.textContent = percentage + '%';
            scoreEl.className = 'results-score ' + (passed ? 'pass' : 'fail');
            const statusEl = document.getElementById('resultStatus');
            statusEl.textContent = passed ? 'üéâ PASSED!' : 'üìö Keep Studying';
            statusEl.className = 'results-status ' + (passed ? 'pass' : 'fail');
            document.getElementById('resultDetails').textContent = `You answered ${correct} out of ${total} questions correctly.`;
            document.getElementById('correctCount').textContent = correct;
            document.getElementById('incorrectCount').textContent = total - correct;
        }

        function restartQuiz() {
            document.getElementById('resultsCard').classList.remove('show');
            document.getElementById('modeSelector').classList.remove('hidden');
            document.getElementById('quizContent').classList.add('hidden');
            if (timerInterval) clearInterval(timerInterval);
        }
    </script>
</body>
</html>
