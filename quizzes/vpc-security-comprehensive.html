<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPC Security Comprehensive Quiz | AWS Security Specialty (SCS-C03)</title>
    <style>
        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #141b2d;
            --bg-tertiary: #1a2236;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --accent-primary: #14b8a6;
            --accent-secondary: #2dd4bf;
            --success: #22c55e;
            --error: #ef4444;
            --warning: #eab308;
            --info: #3b82f6;
            --border: #2d3a52;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg-primary); color: var(--text-primary); line-height: 1.6; min-height: 100vh; }
        .container { max-width: 900px; margin: 0 auto; padding: 2rem; }
        header { text-align: center; margin-bottom: 2rem; padding: 2rem; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%); border-radius: 16px; border: 1px solid var(--border); }
        .badge { display: inline-block; background: var(--accent-primary); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; margin-bottom: 1rem; text-transform: uppercase; }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .subtitle { color: var(--text-secondary); font-size: 1rem; }
        .stats-bar { display: flex; justify-content: center; gap: 2rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border); }
        .stat { text-align: center; }
        .stat-value { font-size: 1.5rem; font-weight: 700; color: var(--accent-primary); }
        .stat-label { font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; }
        .mode-selector { display: flex; gap: 1rem; justify-content: center; margin-bottom: 2rem; }
        .mode-btn { padding: 0.75rem 2rem; border: 2px solid var(--border); background: var(--bg-secondary); color: var(--text-primary); border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease; }
        .mode-btn:hover { border-color: var(--accent-primary); background: var(--bg-tertiary); }
        .mode-btn.active { border-color: var(--accent-primary); background: linear-gradient(135deg, rgba(20, 184, 166, 0.2), rgba(45, 212, 191, 0.1)); }
        .progress-container { background: var(--bg-secondary); border-radius: 12px; padding: 1rem 1.5rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
        .progress-text { font-size: 0.875rem; color: var(--text-secondary); }
        .timer { font-size: 1.25rem; font-weight: 600; color: var(--accent-primary); font-family: 'Consolas', monospace; }
        .timer.warning { color: var(--warning); animation: pulse 1s infinite; }
        .timer.danger { color: var(--error); animation: pulse 0.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .progress-bar { height: 8px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary)); border-radius: 4px; transition: width 0.3s ease; }
        .question-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .question-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
        .question-number { background: var(--bg-tertiary); color: var(--accent-primary); padding: 0.25rem 0.75rem; border-radius: 6px; font-size: 0.875rem; font-weight: 600; }
        .question-domain { font-size: 0.75rem; color: var(--text-secondary); background: var(--bg-tertiary); padding: 0.25rem 0.5rem; border-radius: 4px; }
        .question-text { font-size: 1.125rem; margin-bottom: 1.5rem; line-height: 1.7; }
        .options { display: flex; flex-direction: column; gap: 0.75rem; }
        .option { display: flex; align-items: flex-start; gap: 1rem; padding: 1rem; background: var(--bg-tertiary); border: 2px solid var(--border); border-radius: 10px; cursor: pointer; transition: all 0.2s ease; }
        .option:hover:not(.disabled) { border-color: var(--accent-primary); background: rgba(20, 184, 166, 0.1); }
        .option.selected { border-color: var(--accent-primary); border-width: 3px; background: rgba(20, 184, 166, 0.2); box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.25), inset 0 0 12px rgba(20, 184, 166, 0.1); }
        .option.correct { border-color: var(--success); background: rgba(34, 197, 94, 0.15); }
        .option.incorrect { border-color: var(--error); background: rgba(239, 68, 68, 0.15); }
        .option.disabled { cursor: default; }
        .option-marker { width: 28px; height: 28px; border-radius: 50%; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; flex-shrink: 0; transition: all 0.2s ease; }
        .option.selected .option-marker { border-color: var(--accent-primary); background: var(--accent-primary); color: white; }
        .option.correct .option-marker { border-color: var(--success); background: var(--success); color: white; }
        .option.incorrect .option-marker { border-color: var(--error); background: var(--error); color: white; }
        .option-text { flex: 1; padding-top: 2px; }
        .explanation { margin-top: 1.5rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; border-left: 4px solid var(--info); display: none; }
        .explanation.show { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .explanation-title { display: flex; align-items: center; gap: 0.5rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--info); }
        .answer-header { font-weight: 600; color: var(--success); margin-bottom: 0.5rem; }
        .explanation-text { color: var(--text-secondary); margin-bottom: 1rem; }
        .doc-link { display: inline-flex; align-items: center; gap: 0.5rem; color: var(--accent-primary); text-decoration: none; font-size: 0.875rem; padding: 0.5rem 1rem; background: rgba(20, 184, 166, 0.1); border-radius: 6px; transition: background 0.2s ease; }
        .doc-link:hover { background: rgba(20, 184, 166, 0.2); }
        .btn-container { display: flex; justify-content: space-between; gap: 1rem; margin-top: 1rem; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
        .btn-primary { background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(20, 184, 166, 0.4); }
        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); }
        .btn-secondary:hover { border-color: var(--accent-primary); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .results-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; text-align: center; border: 1px solid var(--border); display: none; }
        .results-card.show { display: block; animation: fadeIn 0.5s ease; }
        .results-score { font-size: 4rem; font-weight: 700; margin: 1rem 0; }
        .results-score.pass { color: var(--success); }
        .results-score.fail { color: var(--error); }
        .results-status { font-size: 1.5rem; margin-bottom: 1rem; }
        .results-status.pass { color: var(--success); }
        .results-status.fail { color: var(--error); }
        .results-details { color: var(--text-secondary); margin-bottom: 2rem; }
        .results-breakdown { display: flex; justify-content: center; gap: 3rem; margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; }
        .breakdown-item { text-align: center; }
        .breakdown-value { font-size: 2rem; font-weight: 700; }
        .breakdown-value.correct { color: var(--success); }
        .breakdown-value.incorrect { color: var(--error); }
        .breakdown-label { font-size: 0.875rem; color: var(--text-secondary); }
        .hidden { display: none !important; }
        .shuffle-notice { text-align: center; padding: 0.75rem; background: rgba(20, 184, 166, 0.1); border-radius: 8px; margin-bottom: 1.5rem; color: var(--accent-secondary); font-size: 0.875rem; }
        @media (max-width: 640px) {
            .container { padding: 1rem; }
            h1 { font-size: 1.5rem; }
            .stats-bar { gap: 1rem; }
            .mode-selector { flex-direction: column; }
            .btn-container { flex-direction: column; }
            .results-breakdown { flex-direction: column; gap: 1.5rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <span class="badge">Domain 3: Infrastructure Security</span>
            <h1>Amazon VPC Security</h1>
            <p class="subtitle">Comprehensive Quiz for AWS Security Specialty (SCS-C03)</p>
            <div class="stats-bar">
                <div class="stat">
                    <div class="stat-value">25</div>
                    <div class="stat-label">Questions</div>
                </div>
                <div class="stat">
                    <div class="stat-value">80%</div>
                    <div class="stat-label">Pass Score</div>
                </div>
                <div class="stat">
                    <div class="stat-value">62:30</div>
                    <div class="stat-label">Exam Time</div>
                </div>
            </div>
        </header>

        <div class="mode-selector" id="modeSelector">
            <button class="mode-btn" onclick="startQuiz('learn')">üìö Learn Mode</button>
            <button class="mode-btn" onclick="startQuiz('exam')">‚è±Ô∏è Exam Mode</button>
        </div>

        <div id="quizContent" class="hidden">
            <div class="progress-container">
                <div class="progress-header">
                    <span class="progress-text">Question <span id="currentQ">1</span> of <span id="totalQ">25</span></span>
                    <span class="timer" id="timer">62:30</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
            </div>
            <div class="shuffle-notice" id="shuffleNotice">üîÄ Questions and options have been randomized</div>
            <div id="questionsContainer"></div>
            <div class="btn-container">
                <button class="btn btn-secondary" id="prevBtn" onclick="navigate(-1)" disabled>‚Üê Previous</button>
                <button class="btn btn-secondary" id="shuffleBtn" onclick="shuffleQuiz()">üîÄ Shuffle</button>
                <button class="btn btn-primary" id="nextBtn" onclick="navigate(1)">Next ‚Üí</button>
            </div>
        </div>

        <div class="results-card" id="resultsCard">
            <h2>Quiz Complete!</h2>
            <div class="results-score" id="scorePercent">0%</div>
            <div class="results-status" id="resultStatus">-</div>
            <p class="results-details" id="resultDetails"></p>
            <div class="results-breakdown">
                <div class="breakdown-item">
                    <div class="breakdown-value correct" id="correctCount">0</div>
                    <div class="breakdown-label">Correct</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-value incorrect" id="incorrectCount">0</div>
                    <div class="breakdown-label">Incorrect</div>
                </div>
            </div>
            <button class="btn btn-primary" onclick="restartQuiz()">üîÑ Restart Quiz</button>
        </div>
    </div>

    <script>
        const questions = [
            {
                id: 1,
                question: "What is the key difference between Security Groups and Network ACLs in terms of state?",
                options: [
                    "Security Groups are stateless, Network ACLs are stateful",
                    "Security Groups are stateful, Network ACLs are stateless",
                    "Both are stateful",
                    "Both are stateless"
                ],
                correct: 1,
                explanation: "Security Groups are stateful - if you allow inbound traffic, the response is automatically allowed out. Network ACLs are stateless - you must explicitly allow both inbound and outbound traffic. This is a fundamental difference that affects how you configure rules for each.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Security.html"
            },
            {
                id: 2,
                question: "At which level do Network ACLs operate?",
                options: [
                    "Instance level (ENI)",
                    "VPC level",
                    "Subnet level",
                    "Region level"
                ],
                correct: 2,
                explanation: "Network ACLs operate at the subnet level. They act as a firewall for controlling traffic in and out of one or more subnets. Each subnet must be associated with a Network ACL, and if none is specified, it uses the default NACL.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html"
            },
            {
                id: 3,
                question: "How are Network ACL rules evaluated?",
                options: [
                    "All rules are evaluated before a decision is made",
                    "Rules are evaluated in random order",
                    "Rules are evaluated in order starting with the lowest numbered rule",
                    "Rules are evaluated based on most specific match"
                ],
                correct: 2,
                explanation: "Network ACL rules are evaluated in order, starting with the lowest numbered rule. As soon as a rule matches traffic, it's applied regardless of any higher-numbered rule that might contradict it. This is why rule ordering is critical in NACLs.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#nacl-rules"
            },
            {
                id: 4,
                question: "What is the default behavior of a newly created Security Group?",
                options: [
                    "Allows all inbound and outbound traffic",
                    "Denies all inbound traffic, allows all outbound traffic",
                    "Denies all inbound and outbound traffic",
                    "Allows all inbound traffic, denies all outbound traffic"
                ],
                correct: 1,
                explanation: "A newly created Security Group denies all inbound traffic by default and allows all outbound traffic. You must add inbound rules to allow specific traffic. The default VPC security group is different - it allows inbound traffic from itself.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html#DefaultSecurityGroup"
            },
            {
                id: 5,
                question: "Which type of VPC endpoint is used for Amazon S3 and DynamoDB?",
                options: [
                    "Interface Endpoint",
                    "Gateway Endpoint",
                    "PrivateLink Endpoint",
                    "Service Endpoint"
                ],
                correct: 1,
                explanation: "Gateway Endpoints are used for Amazon S3 and DynamoDB. They are free and work by adding a route table entry to direct traffic to the service. Interface Endpoints (powered by AWS PrivateLink) are used for most other AWS services and incur hourly charges.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/privatelink/gateway-endpoints.html"
            },
            {
                id: 6,
                question: "What is the purpose of a VPC Endpoint Policy?",
                options: [
                    "To control which IAM users can create endpoints",
                    "To restrict which resources can be accessed through the endpoint",
                    "To encrypt traffic flowing through the endpoint",
                    "To limit the number of connections to the endpoint"
                ],
                correct: 1,
                explanation: "VPC Endpoint Policies control which AWS resources (like specific S3 buckets or DynamoDB tables) can be accessed through the endpoint. They are resource-based policies that can restrict access even if IAM policies would otherwise allow it.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-access.html"
            },
            {
                id: 7,
                question: "What is the key characteristic of VPC Peering connections?",
                options: [
                    "They support transitive routing",
                    "They are non-transitive and require direct connections",
                    "They automatically create routes between VPCs",
                    "They work across different AWS partitions"
                ],
                correct: 1,
                explanation: "VPC Peering is non-transitive. If VPC A is peered with VPC B, and VPC B is peered with VPC C, traffic cannot flow from A to C through B. You would need a direct peering connection between A and C. Routes must also be manually configured.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html"
            },
            {
                id: 8,
                question: "What AWS service provides hub-and-spoke connectivity with transitive routing for multiple VPCs?",
                options: [
                    "VPC Peering",
                    "AWS Direct Connect",
                    "AWS Transit Gateway",
                    "VPC Endpoint"
                ],
                correct: 2,
                explanation: "AWS Transit Gateway provides hub-and-spoke connectivity and supports transitive routing between attached VPCs and on-premises networks. It simplifies network architecture compared to mesh VPC peering by acting as a central hub.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/tgw/what-is-transit-gateway.html"
            },
            {
                id: 9,
                question: "Which VPC Flow Logs field indicates whether traffic was allowed or denied?",
                options: [
                    "status",
                    "action",
                    "protocol",
                    "flow-direction"
                ],
                correct: 1,
                explanation: "The 'action' field in VPC Flow Logs indicates whether the traffic was ACCEPT (allowed) or REJECT (denied) by the security group or network ACL. This field is essential for security analysis and troubleshooting connectivity issues.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html#flow-log-records"
            },
            {
                id: 10,
                question: "Where can VPC Flow Logs be published?",
                options: [
                    "CloudWatch Logs only",
                    "S3 only",
                    "CloudWatch Logs, S3, or Kinesis Data Firehose",
                    "CloudWatch Logs or Kinesis Data Streams"
                ],
                correct: 2,
                explanation: "VPC Flow Logs can be published to three destinations: Amazon CloudWatch Logs (for real-time monitoring), Amazon S3 (for long-term storage and analysis), or Amazon Kinesis Data Firehose (for streaming to various destinations).",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html"
            },
            {
                id: 11,
                question: "What is the purpose of AWS Network Access Analyzer?",
                options: [
                    "To monitor network performance metrics",
                    "To identify unintended network access to resources",
                    "To encrypt network traffic",
                    "To compress network data"
                ],
                correct: 1,
                explanation: "AWS Network Access Analyzer helps you identify unintended network access to your resources in VPCs. It verifies that your network configuration matches your intended network access requirements and can help identify overly permissive security groups.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/network-access-analyzer/"
            },
            {
                id: 12,
                question: "In a Security Group, what happens when you reference another Security Group as a source?",
                options: [
                    "Traffic from any instance with that Security Group is allowed",
                    "Traffic from the Security Group's IP range is allowed",
                    "Traffic is encrypted between the groups",
                    "All ports are automatically opened"
                ],
                correct: 0,
                explanation: "When you reference a Security Group as a source, traffic is allowed from any network interface that is associated with the referenced Security Group. This is more flexible than IP-based rules as it automatically includes new instances added to the referenced group.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html#SecurityGroupRules"
            },
            {
                id: 13,
                question: "What is the maximum number of rules per Security Group in a VPC?",
                options: [
                    "50 inbound and 50 outbound",
                    "60 inbound and 60 outbound",
                    "100 inbound and 100 outbound",
                    "Unlimited rules"
                ],
                correct: 1,
                explanation: "By default, you can have up to 60 inbound and 60 outbound rules per Security Group. This quota can be increased by requesting a service limit increase, but you should consider the performance implications of having many rules.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/amazon-vpc-limits.html"
            },
            {
                id: 14,
                question: "Which Network ACL rule number is reserved and cannot be modified?",
                options: [
                    "Rule 0",
                    "Rule 100",
                    "Rule 32767 (asterisk rule)",
                    "Rule 65535"
                ],
                correct: 2,
                explanation: "Rule number 32767 (displayed as * in the console) is the default deny rule that cannot be modified or deleted. It ensures that if no other rules match, traffic is denied. This rule has the highest number and is evaluated last.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#nacl-rules"
            },
            {
                id: 15,
                question: "What is an Interface Endpoint powered by?",
                options: [
                    "Route table entries",
                    "AWS PrivateLink",
                    "NAT Gateway",
                    "Internet Gateway"
                ],
                correct: 1,
                explanation: "Interface Endpoints are powered by AWS PrivateLink. They create an elastic network interface (ENI) with a private IP address in your subnet that serves as an entry point for traffic destined to the supported service.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/privatelink/privatelink-share-your-services.html"
            },
            {
                id: 16,
                question: "What is VPC Sharing used for?",
                options: [
                    "Sharing internet bandwidth between VPCs",
                    "Allowing multiple AWS accounts to create resources in shared subnets",
                    "Sharing security groups between VPCs",
                    "Replicating VPC configurations across regions"
                ],
                correct: 1,
                explanation: "VPC Sharing allows multiple AWS accounts (within the same AWS Organization) to create resources in shared subnets. The owner account shares subnets with other accounts using AWS Resource Access Manager, reducing the need for VPC peering.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-sharing.html"
            },
            {
                id: 17,
                question: "Which feature should you use to log all IP traffic going to and from network interfaces in your VPC?",
                options: [
                    "AWS CloudTrail",
                    "VPC Flow Logs",
                    "AWS Config",
                    "Amazon Inspector"
                ],
                correct: 1,
                explanation: "VPC Flow Logs capture information about the IP traffic going to and from network interfaces in your VPC. They can be created at the VPC, subnet, or network interface level, and the data is published to CloudWatch Logs, S3, or Kinesis Data Firehose.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html"
            },
            {
                id: 18,
                question: "What is the default Network ACL behavior for a VPC?",
                options: [
                    "Denies all inbound and outbound traffic",
                    "Allows all inbound and outbound traffic",
                    "Allows inbound, denies outbound",
                    "Denies inbound, allows outbound"
                ],
                correct: 1,
                explanation: "The default Network ACL for a VPC allows all inbound and outbound traffic. When you create a custom Network ACL, it denies all traffic by default until you add rules. This is the opposite of the default Security Group behavior.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#default-network-acl"
            },
            {
                id: 19,
                question: "What type of traffic does a NAT Gateway NOT support?",
                options: [
                    "HTTP traffic",
                    "HTTPS traffic",
                    "Inbound connections initiated from the internet",
                    "ICMP traffic"
                ],
                correct: 2,
                explanation: "NAT Gateway only supports outbound internet connectivity. It does not support inbound connections initiated from the internet. For inbound connections, you would need to use a load balancer, bastion host, or place resources in a public subnet.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html"
            },
            {
                id: 20,
                question: "What is the purpose of egress-only Internet Gateway?",
                options: [
                    "To provide outbound IPv4 connectivity for private subnets",
                    "To provide outbound IPv6 connectivity while preventing inbound IPv6 connections",
                    "To filter outbound traffic for malware",
                    "To compress outbound data"
                ],
                correct: 1,
                explanation: "An egress-only Internet Gateway enables outbound IPv6 traffic from instances in a VPC while preventing inbound IPv6 connections from the internet. It's similar to a NAT Gateway but for IPv6 traffic (IPv6 addresses are globally unique and public by default).",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/egress-only-internet-gateway.html"
            },
            {
                id: 21,
                question: "Which service can you use to centrally manage Security Groups across multiple accounts?",
                options: [
                    "AWS Organizations",
                    "AWS Config",
                    "AWS Firewall Manager",
                    "AWS Security Hub"
                ],
                correct: 2,
                explanation: "AWS Firewall Manager allows you to centrally configure and manage Security Groups across your accounts and applications in AWS Organizations. You can define security group policies and have them automatically applied to new resources.",
                docLink: "https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html"
            },
            {
                id: 22,
                question: "What happens to VPC Flow Logs data if the log group or S3 bucket is deleted?",
                options: [
                    "The flow log continues to work with a new destination",
                    "The flow log enters an error state and stops capturing traffic",
                    "AWS automatically creates a new destination",
                    "The flow log data is cached until destination is restored"
                ],
                correct: 1,
                explanation: "If the CloudWatch Logs log group or S3 bucket destination is deleted, the VPC Flow Log enters an error state and stops capturing traffic. You would need to delete the flow log and create a new one with a valid destination to resume logging.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs-troubleshooting.html"
            },
            {
                id: 23,
                question: "Which of the following is NOT a valid VPC Flow Logs traffic type filter?",
                options: [
                    "ACCEPT",
                    "REJECT",
                    "ALL",
                    "ALLOW"
                ],
                correct: 3,
                explanation: "VPC Flow Logs support three traffic type filters: ACCEPT (captures only allowed traffic), REJECT (captures only denied traffic), and ALL (captures both). 'ALLOW' is not a valid filter value.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html#flow-logs-basics"
            },
            {
                id: 24,
                question: "What is the recommended approach for creating Network ACL rules for ephemeral ports?",
                options: [
                    "Only allow ports 1024-65535 for inbound",
                    "Allow the ephemeral port range based on client operating system",
                    "Block all ephemeral ports for security",
                    "Use Security Groups instead of NACLs for ephemeral ports"
                ],
                correct: 1,
                explanation: "Because NACLs are stateless, you must explicitly allow ephemeral ports for return traffic. Different client operating systems use different ephemeral port ranges (e.g., Linux: 32768-61000, Windows: 49152-65535). For flexibility, many allow 1024-65535.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#nacl-ephemeral-ports"
            },
            {
                id: 25,
                question: "What is AWS PrivateLink used for?",
                options: [
                    "Creating private VPN connections",
                    "Privately accessing services across VPCs without using the internet",
                    "Encrypting data at rest in VPCs",
                    "Managing private DNS zones"
                ],
                correct: 1,
                explanation: "AWS PrivateLink provides private connectivity between VPCs, AWS services, and on-premises networks without exposing traffic to the public internet. It creates interface endpoints (ENIs) in your VPC that route traffic privately to services.",
                docLink: "https://docs.aws.amazon.com/vpc/latest/privatelink/what-is-privatelink.html"
            }
        ];

        let currentMode = 'learn', answersRevealed = [];
        let currentQuestion = 0;
        let userAnswers = [];
        let shuffledQuestions = [];
        let timerInterval = null;
        let timeRemaining = 0;

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function shuffleQuestionOptions(question) {
            const optionIndices = [0, 1, 2, 3];
            const shuffledIndices = shuffleArray(optionIndices);
            const newQuestion = { ...question };
            newQuestion.options = shuffledIndices.map(i => question.options[i]);
            newQuestion.correct = shuffledIndices.indexOf(question.correct);
            newQuestion.shuffleMap = shuffledIndices;
            return newQuestion;
        }

        function startQuiz(mode) {
            currentMode = mode;
            currentQuestion = 0;
            userAnswers = new Array(questions.length).fill(null);
            answersRevealed = new Array(questions.length).fill(false);
            shuffledQuestions = shuffleArray(questions).map(q => shuffleQuestionOptions(q));
            document.getElementById('modeSelector').classList.add('hidden');
            document.getElementById('quizContent').classList.remove('hidden');
            document.getElementById('resultsCard').classList.remove('hidden');
            document.getElementById('resultsCard').classList.remove('show');
            document.getElementById('totalQ').textContent = shuffledQuestions.length;
            if (mode === 'exam') {
                timeRemaining = shuffledQuestions.length * 150;
                startTimer();
                document.getElementById('shuffleBtn').classList.add('hidden');
            } else {
                document.getElementById('timer').textContent = 'Learn Mode';
                document.getElementById('shuffleBtn').classList.remove('hidden');
            }
            renderQuestion();
        }

        function startTimer() {
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    showResults();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const timerEl = document.getElementById('timer');
            timerEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            timerEl.classList.remove('warning', 'danger');
            if (timeRemaining <= 60) timerEl.classList.add('danger');
            else if (timeRemaining <= 300) timerEl.classList.add('warning');
        }

        function renderQuestion() {
            const q = shuffledQuestions[currentQuestion];
            const container = document.getElementById('questionsContainer');
            const letters = ['A', 'B', 'C', 'D'];
            const userAnswer = userAnswers[currentQuestion];
            let optionsHtml = q.options.map((opt, idx) => {
                let classes = 'option';
                if (currentMode === 'learn' && userAnswer !== null) {
                    classes += ' disabled';
                    if (idx === q.correct) classes += ' correct';
                    else if (idx === userAnswer) classes += ' incorrect';
                } else if (userAnswer === idx) {
                    classes += ' selected';
                }
                return `<div class="${classes}" onclick="selectOption(${idx})">
                    <span class="option-marker">${letters[idx]}</span>
                    <span class="option-text">${opt}</span>
                </div>`;
            }).join('');
            let explanationHtml = '';
            if (currentMode === 'learn') {
                explanationHtml = `<div class="explanation ${userAnswer !== null ? 'show' : ''}" id="explanation">
                    <div class="explanation-title">üìñ Explanation</div>
                    <div class="answer-header">Correct Answer: ${letters[q.correct]}</div>
                    <p class="explanation-text">${q.explanation}</p>
                    <a href="${q.docLink}" target="_blank" class="doc-link">üìÑ View AWS Documentation ‚Üí</a>
                </div>`;
            }
            container.innerHTML = `<div class="question-card">
                <div class="question-header">
                    <span class="question-number">Question ${currentQuestion + 1}</span>
                    <span class="question-domain">VPC Security</span>
                </div>
                <p class="question-text">${q.question}</p>
                <div class="options">${optionsHtml}</div>
                ${currentMode === 'learn' && userAnswer === null ? '<button class="btn btn-primary" style="margin-top: 1rem; width: 100%;" onclick="revealAnswer()">Show Answer</button>' : ''}
                ${explanationHtml}
            </div>`;
            document.getElementById('currentQ').textContent = currentQuestion + 1;
            document.getElementById('progressFill').style.width = `${((currentQuestion + 1) / shuffledQuestions.length) * 100}%`;
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            const nextBtn = document.getElementById('nextBtn');
            if (currentQuestion === shuffledQuestions.length - 1) {
                nextBtn.textContent = currentMode === 'exam' ? 'Submit Quiz' : 'See Results';
            } else {
                nextBtn.textContent = 'Next ‚Üí';
            }
        }

        function selectOption(idx) {
            if (currentMode === 'learn' && answersRevealed[currentQuestion]) return;
            userAnswers[currentQuestion] = idx;
            if (currentMode === 'exam') renderQuestion();
        }

        function revealAnswer() {
            if (userAnswers[currentQuestion] === null) userAnswers[currentQuestion] = -1;
            answersRevealed[currentQuestion] = true;
            renderQuestion();
        }

        function navigate(direction) {
            if (direction === 1 && currentQuestion === shuffledQuestions.length - 1) {
                showResults();
                return;
            }
            currentQuestion += direction;
            currentQuestion = Math.max(0, Math.min(currentQuestion, shuffledQuestions.length - 1));
            renderQuestion();
        }

        function shuffleQuiz() {
            if (currentMode !== 'learn') return;
            currentQuestion = 0;
            userAnswers = new Array(questions.length).fill(null);
            answersRevealed = new Array(questions.length).fill(false);
            shuffledQuestions = shuffleArray(questions).map(q => shuffleQuestionOptions(q));
            renderQuestion();
            const notice = document.getElementById('shuffleNotice');
            notice.style.animation = 'none';
            notice.offsetHeight;
            notice.style.animation = 'fadeIn 0.5s ease';
        }

        function showResults() {
            if (timerInterval) clearInterval(timerInterval);
            let correct = 0;
            shuffledQuestions.forEach((q, idx) => {
                if (userAnswers[idx] !== null && userAnswers[idx] !== -1 && userAnswers[idx] === q.correct) correct++;
            });
            const total = shuffledQuestions.length;
            const percentage = Math.round((correct / total) * 100);
            const passed = percentage >= 80;
            document.getElementById('quizContent').classList.add('hidden');
            document.getElementById('resultsCard').classList.add('show');
            const scoreEl = document.getElementById('scorePercent');
            scoreEl.textContent = percentage + '%';
            scoreEl.className = 'results-score ' + (passed ? 'pass' : 'fail');
            const statusEl = document.getElementById('resultStatus');
            statusEl.textContent = passed ? 'üéâ PASSED!' : 'üìö Keep Studying';
            statusEl.className = 'results-status ' + (passed ? 'pass' : 'fail');
            document.getElementById('resultDetails').textContent = `You answered ${correct} out of ${total} questions correctly. ${passed ? 'Great job!' : 'You need 80% to pass.'}`;
            document.getElementById('correctCount').textContent = correct;
            document.getElementById('incorrectCount').textContent = total - correct;
        }

        function restartQuiz() {
            document.getElementById('resultsCard').classList.remove('show');
            document.getElementById('modeSelector').classList.remove('hidden');
            document.getElementById('quizContent').classList.add('hidden');
            if (timerInterval) clearInterval(timerInterval);
        }
    </script>
</body>
</html>
