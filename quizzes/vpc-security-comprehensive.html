<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPC Security Comprehensive Quiz | AWS Security Specialty (SCS-C03)</title>
    <style>
        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #141b2d;
            --bg-tertiary: #1a2236;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --accent-primary: #14b8a6;
            --accent-secondary: #2dd4bf;
            --success: #22c55e;
            --error: #ef4444;
            --warning: #eab308;
            --info: #3b82f6;
            --border: #2d3a52;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg-primary); color: var(--text-primary); line-height: 1.6; min-height: 100vh; }
        .container { max-width: 900px; margin: 0 auto; padding: 2rem; }
        header { text-align: center; margin-bottom: 2rem; padding: 2rem; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%); border-radius: 16px; border: 1px solid var(--border); }
        .badge { display: inline-block; background: var(--accent-primary); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; margin-bottom: 1rem; text-transform: uppercase; }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .subtitle { color: var(--text-secondary); font-size: 1rem; }
        .stats-bar { display: flex; justify-content: center; gap: 2rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border); }
        .stat { text-align: center; }
        .stat-value { font-size: 1.5rem; font-weight: 700; color: var(--accent-primary); }
        .stat-label { font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; }
        .mode-selector { display: flex; gap: 1rem; justify-content: center; margin-bottom: 2rem; }
        .mode-btn { padding: 0.75rem 2rem; border: 2px solid var(--border); background: var(--bg-secondary); color: var(--text-primary); border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease; }
        .mode-btn:hover { border-color: var(--accent-primary); background: var(--bg-tertiary); }
        .mode-btn.active { border-color: var(--accent-primary); background: linear-gradient(135deg, rgba(20, 184, 166, 0.2), rgba(45, 212, 191, 0.1)); }
        .progress-container { background: var(--bg-secondary); border-radius: 12px; padding: 1rem 1.5rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
        .progress-text { font-size: 0.875rem; color: var(--text-secondary); }
        .timer { font-size: 1.25rem; font-weight: 600; color: var(--accent-primary); font-family: 'Consolas', monospace; }
        .timer.warning { color: var(--warning); animation: pulse 1s infinite; }
        .timer.danger { color: var(--error); animation: pulse 0.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .progress-bar { height: 8px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary)); border-radius: 4px; transition: width 0.3s ease; }
        .question-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; margin-bottom: 1.5rem; border: 1px solid var(--border); }
        .question-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
        .question-number { background: var(--bg-tertiary); color: var(--accent-primary); padding: 0.25rem 0.75rem; border-radius: 6px; font-size: 0.875rem; font-weight: 600; }
        .question-domain { font-size: 0.75rem; color: var(--text-secondary); background: var(--bg-tertiary); padding: 0.25rem 0.5rem; border-radius: 4px; }
        .question-text { font-size: 1.125rem; margin-bottom: 1.5rem; line-height: 1.7; }
        .options { display: flex; flex-direction: column; gap: 0.75rem; }
        .option { display: flex; align-items: flex-start; gap: 1rem; padding: 1rem; background: var(--bg-tertiary); border: 2px solid var(--border); border-radius: 10px; cursor: pointer; transition: all 0.2s ease; }
        .option:hover:not(.disabled) { border-color: var(--accent-primary); background: rgba(20, 184, 166, 0.1); }
        .option.selected { border-color: var(--accent-primary); border-width: 3px; background: rgba(20, 184, 166, 0.2); box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.25), inset 0 0 12px rgba(20, 184, 166, 0.1); }
        .option.correct { border-color: var(--success); background: rgba(34, 197, 94, 0.15); }
        .option.incorrect { border-color: var(--error); background: rgba(239, 68, 68, 0.15); }
        .option.disabled { cursor: default; }
        .option-marker { width: 28px; height: 28px; border-radius: 50%; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; flex-shrink: 0; transition: all 0.2s ease; }
        .option.selected .option-marker { border-color: var(--accent-primary); background: var(--accent-primary); color: white; }
        .option.correct .option-marker { border-color: var(--success); background: var(--success); color: white; }
        .option.incorrect .option-marker { border-color: var(--error); background: var(--error); color: white; }
        .option-text { flex: 1; padding-top: 2px; }
        .explanation { margin-top: 1.5rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; border-left: 4px solid var(--info); display: none; }
        .explanation.show { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .explanation-title { display: flex; align-items: center; gap: 0.5rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--info); }
        .answer-header { font-weight: 600; color: var(--success); margin-bottom: 0.5rem; }
        .explanation-text { color: var(--text-secondary); margin-bottom: 1rem; }
        .doc-link { display: inline-flex; align-items: center; gap: 0.5rem; color: var(--accent-primary); text-decoration: none; font-size: 0.875rem; padding: 0.5rem 1rem; background: rgba(20, 184, 166, 0.1); border-radius: 6px; transition: background 0.2s ease; }
        .doc-link:hover { background: rgba(20, 184, 166, 0.2); }
        .btn-container { display: flex; justify-content: space-between; gap: 1rem; margin-top: 1rem; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
        .btn-primary { background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(20, 184, 166, 0.4); }
        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); }
        .btn-secondary:hover { border-color: var(--accent-primary); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .results-card { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; text-align: center; border: 1px solid var(--border); display: none; }
        .results-card.show { display: block; animation: fadeIn 0.5s ease; }
        .results-score { font-size: 4rem; font-weight: 700; margin: 1rem 0; }
        .results-score.pass { color: var(--success); }
        .results-score.fail { color: var(--error); }
        .results-status { font-size: 1.5rem; margin-bottom: 1rem; }
        .results-status.pass { color: var(--success); }
        .results-status.fail { color: var(--error); }
        .results-details { color: var(--text-secondary); margin-bottom: 2rem; }
        .results-breakdown { display: flex; justify-content: center; gap: 3rem; margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-tertiary); border-radius: 10px; }
        .breakdown-item { text-align: center; }
        .breakdown-value { font-size: 2rem; font-weight: 700; }
        .breakdown-value.correct { color: var(--success); }
        .breakdown-value.incorrect { color: var(--error); }
        .breakdown-label { font-size: 0.875rem; color: var(--text-secondary); }
        .hidden { display: none !important; }
        .shuffle-notice { text-align: center; padding: 0.75rem; background: rgba(20, 184, 166, 0.1); border-radius: 8px; margin-bottom: 1.5rem; color: var(--accent-secondary); font-size: 0.875rem; }
        .btn-group { display: flex; gap: 1rem; justify-content: center; margin-top: 1rem; }
        .review-section { background: var(--bg-secondary); border-radius: 16px; padding: 2rem; border: 1px solid var(--border); display: none; }
        .review-section.show { display: block; animation: fadeIn 0.5s ease; }
        .review-header { text-align: center; margin-bottom: 2rem; }
        .review-hint { text-align: center; color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 1rem; }
        .review-table { width: 100%; border-collapse: collapse; margin-bottom: 2rem; }
        .review-table th { background: var(--bg-tertiary); color: var(--text-secondary); font-size: 0.875rem; font-weight: 600; text-transform: uppercase; padding: 1rem; text-align: left; border-bottom: 2px solid var(--border); }
        .review-table td { padding: 1rem; border-bottom: 1px solid var(--border); vertical-align: top; }
        .review-table tbody tr { cursor: pointer; transition: all 0.2s ease; }
        .review-table tbody tr:hover { background: rgba(20, 184, 166, 0.1); transform: translateX(4px); }
        .review-table tbody tr.reviewed { background: rgba(20, 184, 166, 0.25); border-left: 6px solid var(--accent-primary); box-shadow: inset 0 0 20px rgba(20, 184, 166, 0.15); }
        .review-table tbody tr.reviewed:hover { background: rgba(20, 184, 166, 0.3); }
        .review-table tbody tr.reviewed .review-q-num { color: var(--accent-secondary); font-weight: 800; }
        .review-table tbody tr.reviewed .review-q-num::before { content: "‚úì "; color: var(--accent-primary); font-size: 1rem; }
        .review-q-num { font-weight: 700; color: var(--accent-primary); white-space: nowrap; }
        .review-q-text { color: var(--text-primary); line-height: 1.6; }
        .review-answer { font-weight: 600; }
        .review-answer.correct { color: var(--success); }
        .review-answer.incorrect { color: var(--error); }
        .review-status { text-align: center; font-size: 1.25rem; }
        @media (max-width: 640px) {
            .container { padding: 1rem; }
            h1 { font-size: 1.5rem; }
            .stats-bar { gap: 1rem; }
            .mode-selector { flex-direction: column; }
            .btn-container { flex-direction: column; }
            .results-breakdown { flex-direction: column; gap: 1.5rem; }
            .btn-group { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <span class="badge">Domain 3: Infrastructure Security</span>
            <h1>Amazon VPC Security</h1>
            <p class="subtitle">Comprehensive Quiz for AWS Security Specialty (SCS-C03)</p>
            <div class="stats-bar">
                <div class="stat">
                    <div class="stat-value">25</div>
                    <div class="stat-label">Questions</div>
                </div>
                <div class="stat">
                    <div class="stat-value">80%</div>
                    <div class="stat-label">Pass Score</div>
                </div>
                <div class="stat">
                    <div class="stat-value">62:30</div>
                    <div class="stat-label">Exam Time</div>
                </div>
            </div>
        </header>

        <div class="mode-selector" id="modeSelector">
            <button class="mode-btn" onclick="startQuiz('learn')">üìö Learn Mode</button>
            <button class="mode-btn" onclick="startQuiz('exam')">‚è±Ô∏è Exam Mode</button>
        </div>

        <div id="quizContent" class="hidden">
            <div class="progress-container">
                <div class="progress-header">
                    <span class="progress-text">Question <span id="currentQ">1</span> of <span id="totalQ">25</span></span>
                    <span class="timer" id="timer">62:30</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
            </div>
            <div class="shuffle-notice" id="shuffleNotice">üîÄ Questions and options have been randomized</div>
            <div id="questionsContainer"></div>
            <div class="btn-container">
                <button class="btn btn-secondary" id="backToReviewBtn" onclick="backToReview()" style="display: none;">‚Üê Back to Review</button>
                <button class="btn btn-secondary" id="prevBtn" onclick="navigate(-1)" disabled>‚Üê Previous</button>
                <button class="btn btn-secondary" id="shuffleBtn" onclick="shuffleQuiz()">üîÄ Shuffle</button>
                <button class="btn btn-primary" id="nextBtn" onclick="navigate(1)">Next ‚Üí</button>
            </div>
        </div>

        <div class="results-card" id="resultsCard">
            <h2>Quiz Complete!</h2>
            <div class="results-score" id="scorePercent">0%</div>
            <div class="results-status" id="resultStatus">-</div>
            <p class="results-details" id="resultDetails"></p>
            <div class="results-breakdown">
                <div class="breakdown-item">
                    <div class="breakdown-value correct" id="correctCount">0</div>
                    <div class="breakdown-label">Correct</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-value incorrect" id="incorrectCount">0</div>
                    <div class="breakdown-label">Incorrect</div>
                </div>
            </div>
            <div class="btn-group" id="resultsButtons">
                <button class="btn btn-primary" onclick="showReview()">üìä Review Answers</button>
                <button class="btn btn-secondary" onclick="restartQuiz()">üîÑ Restart Quiz</button>
            </div>
        </div>
        <div class="review-section" id="reviewSection">
            <div class="review-header">
                <h2>Answer Review</h2>
                <p class="results-details">Click any question to review the full answer and explanation</p>
            </div>
            <p class="review-hint">üí° Tip: Click on any row to see the full question and explanation in Learn mode</p>
            <table class="review-table">
                <thead>
                    <tr>
                        <th style="width: 5%">#</th>
                        <th style="width: 50%">Question</th>
                        <th style="width: 15%">Your Answer</th>
                        <th style="width: 15%">Correct Answer</th>
                        <th style="width: 15%">Status</th>
                    </tr>
                </thead>
                <tbody id="reviewTableBody"></tbody>
            </table>
            <div class="review-status">
                <p class="results-details">Reviewed: <span id="reviewedCount">0</span> / <span id="totalReviewCount">0</span> questions</p>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="backToResults()">‚Üê Back to Results</button>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            { id: 1, question: "A security engineer notices that a web application's EC2 instances can receive responses from external services but doesn't understand why, since they only configured inbound HTTPS rules on the Security Group. What explains this behavior?", options: ["Network ACLs are automatically allowing the return traffic", "Security Groups are stateful - return traffic for allowed outbound connections is automatically permitted", "The default VPC route table includes implicit allow rules for responses", "AWS automatically creates temporary inbound rules for established connections"], correct: 1, explanation: "Security Groups are stateful. When you allow outbound traffic (which is allowed by default), the return traffic is automatically allowed regardless of inbound rules. This is different from Network ACLs, which are stateless and require explicit rules for both directions.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Security.html" },
            { id: 2, question: "A company needs to block traffic from specific malicious IP addresses at the subnet level before it reaches any EC2 instances. The security team wants rules evaluated in a specific order. Which option should they use?", options: ["Security Groups with deny rules configured at the top of the rule list", "Network ACLs with deny rules using low rule numbers to ensure early evaluation", "AWS WAF rules attached directly to the VPC", "VPC Flow Logs configured to reject matching traffic patterns"], correct: 1, explanation: "Network ACLs operate at the subnet level and evaluate rules in order starting with the lowest numbered rule. By placing deny rules with low numbers (e.g., 100), you ensure malicious IPs are blocked before any allow rules. Security Groups don't support explicit deny rules.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#nacl-rules" },
            { id: 3, question: "An engineer creates a new Security Group for a database tier and attaches it to RDS instances. Application servers cannot connect to the database. What is the most likely cause?", options: ["The default NACL is blocking the database port", "New Security Groups deny all inbound traffic by default - an inbound rule for the database port is needed", "RDS requires a specific Security Group naming convention", "The Security Group was created in the wrong Availability Zone"], correct: 1, explanation: "A newly created Security Group denies all inbound traffic by default and allows all outbound. The engineer must add an inbound rule allowing the database port (e.g., 3306 for MySQL) from the application Security Group or CIDR range.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html#DefaultSecurityGroup" },
            { id: 4, question: "A company wants EC2 instances in a private subnet to access S3 without traversing the internet or NAT Gateway. The solution must be free and not require ENIs. Which approach should they use?", options: ["Create an Interface Endpoint for S3 in each Availability Zone", "Create a Gateway Endpoint for S3 and add it to the route table", "Configure a VPN connection to the S3 service endpoint", "Enable S3 Transfer Acceleration for private subnet access"], correct: 1, explanation: "Gateway Endpoints for S3 and DynamoDB are free and work by adding a route table entry. They don't require ENIs like Interface Endpoints. Interface Endpoints incur hourly charges and per-GB data processing fees.", docLink: "https://docs.aws.amazon.com/vpc/latest/privatelink/gateway-endpoints.html" },
            { id: 5, question: "A security architect needs to ensure that EC2 instances can only access specific S3 buckets through a VPC Endpoint, even if IAM policies allow broader access. What should they configure?", options: ["S3 bucket policies that deny access from outside the VPC", "A VPC Endpoint Policy that restricts access to only the allowed S3 buckets", "IAM policies with VPC source conditions attached to the EC2 instance role", "Network ACLs that filter traffic based on S3 bucket ARNs"], correct: 1, explanation: "VPC Endpoint Policies control which AWS resources can be accessed through the endpoint. They act as an additional layer of access control - even if IAM allows access to other buckets, the endpoint policy can restrict traffic to specific buckets only.", docLink: "https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-access.html" },
            { id: 6, question: "Three VPCs need to communicate: VPC-A is peered with VPC-B, and VPC-B is peered with VPC-C. Users in VPC-A report they cannot reach resources in VPC-C. What is the issue?", options: ["VPC peering connections require identical CIDR blocks to route traffic", "VPC Peering is non-transitive - VPC-A needs a direct peering connection to VPC-C", "The route tables in VPC-B are incorrectly configured for transitive routing", "Cross-region VPC peering is not supported between three VPCs"], correct: 1, explanation: "VPC Peering is non-transitive. Traffic cannot flow from VPC-A to VPC-C through VPC-B. A direct peering connection between VPC-A and VPC-C is required, or you should use AWS Transit Gateway for hub-and-spoke connectivity.", docLink: "https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html" },
            { id: 7, question: "A company has 15 VPCs that all need to communicate with each other and with on-premises networks. Managing 100+ peering connections is becoming unmanageable. What is the recommended solution?", options: ["Consolidate all workloads into a single VPC with multiple subnets", "Deploy AWS Transit Gateway as a central hub for VPC and on-premises connectivity", "Use AWS PrivateLink to create service endpoints between all VPCs", "Configure AWS Direct Connect with a separate connection per VPC"], correct: 1, explanation: "AWS Transit Gateway provides hub-and-spoke connectivity with transitive routing. Instead of N*(N-1)/2 peering connections, you attach each VPC to the Transit Gateway. It also supports VPN and Direct Connect for on-premises connectivity.", docLink: "https://docs.aws.amazon.com/vpc/latest/tgw/what-is-transit-gateway.html" },
            { id: 8, question: "A security analyst investigating a potential breach needs to determine if traffic was allowed or blocked by network controls. Which VPC Flow Logs field should they examine?", options: ["The 'status' field which shows ALLOWED or BLOCKED", "The 'action' field which shows ACCEPT or REJECT", "The 'log-status' field which shows OK or DENIED", "The 'tcp-flags' field which indicates connection state"], correct: 1, explanation: "The 'action' field in VPC Flow Logs indicates ACCEPT (traffic allowed) or REJECT (traffic denied) by the security group or network ACL. This is essential for security investigations and troubleshooting connectivity issues.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html#flow-log-records" },
            { id: 9, question: "A company requires long-term storage of VPC Flow Logs for compliance (7 years) and also needs real-time alerting on suspicious traffic patterns. What is the most cost-effective architecture?", options: ["Send all logs to CloudWatch Logs and configure a 7-year retention period", "Publish logs to S3 for long-term storage and to CloudWatch Logs for real-time analysis", "Use only Kinesis Data Firehose which supports both storage and real-time processing", "Store logs in CloudWatch Logs and export to S3 monthly using Lambda"], correct: 1, explanation: "VPC Flow Logs can publish to multiple destinations. S3 is cost-effective for long-term storage (7 years). CloudWatch Logs enables real-time metric filters and alarms for security monitoring. This dual approach optimizes cost and functionality.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html" },
            { id: 10, question: "After a security audit, an organization needs to verify that no unintended network paths exist to their database subnets from the internet. Which AWS service should they use?", options: ["Amazon Inspector to scan for network vulnerabilities", "AWS Network Access Analyzer to identify unintended access paths", "VPC Reachability Analyzer to test specific source-destination pairs", "AWS Trusted Advisor to check security group configurations"], correct: 1, explanation: "AWS Network Access Analyzer helps identify unintended network access by analyzing your VPC configuration against your intended access requirements. It can identify paths you didn't intend to exist, like overly permissive security groups.", docLink: "https://docs.aws.amazon.com/vpc/latest/network-access-analyzer/" },
            { id: 11, question: "An application tier Security Group needs to allow traffic from any instance in the web tier, even as instances are added or removed dynamically. What is the best approach?", options: ["Use the web tier's subnet CIDR as the source in the application tier Security Group", "Reference the web tier Security Group as the source in the application tier Security Group inbound rule", "Create an AWS Lambda function to update IP-based rules when instances change", "Use Elastic IPs on all web tier instances and whitelist those IPs"], correct: 1, explanation: "Referencing a Security Group as the source allows traffic from any instance associated with that Security Group. This is dynamic - new instances automatically get access, removed instances lose access. No manual updates needed.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html#SecurityGroupRules" },
            { id: 12, question: "A security team needs to apply the same firewall rules to subnets across 50 AWS accounts. Manually managing Network ACLs in each account is error-prone. What solution provides centralized management?", options: ["AWS Organizations with Service Control Policies for network rules", "AWS Firewall Manager with Security Group policies across the organization", "AWS Config with conformance packs for NACL compliance", "AWS CloudFormation StackSets to deploy NACLs to all accounts"], correct: 1, explanation: "AWS Firewall Manager provides centralized Security Group policy management across AWS Organizations. Policies are automatically applied to new accounts and resources. While CloudFormation StackSets can deploy NACLs, Firewall Manager provides ongoing compliance enforcement.", docLink: "https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html" },
            { id: 13, question: "A developer's NACL has rule 100 allowing SSH from 10.0.0.0/8, rule 200 denying SSH from 10.1.0.0/16, and rule * (32767) denying all. Traffic from 10.1.0.50 is being allowed. Why?", options: ["The asterisk rule takes precedence for specific subnets", "Rule 100 matches first because NACL rules are evaluated from lowest to highest number", "NACL rules are evaluated based on most specific CIDR match", "Inbound and outbound rules are evaluated separately causing the allow"], correct: 1, explanation: "NACL rules are evaluated in order starting with the lowest numbered rule. Rule 100 (allow 10.0.0.0/8) matches 10.1.0.50 before rule 200 (deny 10.1.0.0/16) is evaluated. The deny rule never gets processed. Rule ordering is critical in NACLs.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#nacl-rules" },
            { id: 14, question: "A company is enabling IPv6 in their VPC. Private subnet instances need outbound IPv6 internet access but must NOT accept inbound connections from the internet. What should they deploy?", options: ["A NAT Gateway which handles both IPv4 and IPv6 translation", "An Egress-only Internet Gateway for outbound IPv6 while blocking inbound IPv6", "An Internet Gateway with NACL rules blocking inbound IPv6", "A proxy server in a public subnet for IPv6 traffic"], correct: 1, explanation: "Egress-only Internet Gateways provide outbound IPv6 connectivity while preventing inbound IPv6 connections from the internet. Unlike IPv4 private addresses, IPv6 addresses are globally unique and routable, requiring this special component.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/egress-only-internet-gateway.html" },
            { id: 15, question: "A company wants to privately expose an internal NLB-based service to partner AWS accounts without VPC peering or public internet exposure. What should they use?", options: ["AWS Transit Gateway with route table associations for partner accounts", "AWS PrivateLink with a VPC Endpoint Service backed by the NLB", "AWS Resource Access Manager to share the NLB directly", "Cross-account IAM roles with VPC CIDR whitelisting"], correct: 1, explanation: "AWS PrivateLink allows you to create VPC Endpoint Services backed by NLB. Partners create Interface Endpoints in their VPCs to access your service privately. Traffic never traverses the public internet and no VPC peering is required.", docLink: "https://docs.aws.amazon.com/vpc/latest/privatelink/privatelink-share-your-services.html" },
            { id: 16, question: "Multiple development teams in different AWS accounts need to deploy resources into the same subnet for a shared project. Each team should manage their own resources. What feature enables this?", options: ["VPC Peering with cross-account security group references", "VPC Sharing through AWS Resource Access Manager", "AWS Organizations with delegated VPC administration", "Cross-account IAM roles with VPC resource permissions"], correct: 1, explanation: "VPC Sharing allows the VPC owner to share subnets with other AWS accounts in the same Organization using RAM. Participant accounts can create their own resources (EC2, RDS, etc.) in shared subnets while the owner manages the VPC infrastructure.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-sharing.html" },
            { id: 17, question: "An engineer creates a custom NACL and associates it with a new subnet. All traffic to instances in the subnet is being blocked. What is the most likely issue?", options: ["Custom NACLs require explicit allow rules - they deny all traffic by default", "The Security Groups attached to instances override the NACL settings", "Custom NACLs must be associated with at least two subnets to function", "The NACL is missing the required default allow rule for VPC traffic"], correct: 0, explanation: "Custom NACLs deny all traffic by default (unlike the default NACL which allows all). The engineer must add explicit allow rules for desired traffic. This is the opposite of newly created Security Groups, which allow all outbound but deny inbound.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#custom-network-acl" },
            { id: 18, question: "A web application in a private subnet needs to download security patches from the internet, but should not accept any inbound connections from outside the VPC. What is the correct architecture?", options: ["Place the instances in a public subnet with restrictive Security Groups", "Use a NAT Gateway in a public subnet with route table pointing 0.0.0.0/0 to the NAT Gateway", "Configure an Internet Gateway with NACL rules blocking inbound traffic", "Deploy AWS PrivateLink endpoints for all patch repositories"], correct: 1, explanation: "NAT Gateway enables outbound internet connectivity for private subnet instances while blocking all inbound connections initiated from the internet. The route table for the private subnet directs 0.0.0.0/0 to the NAT Gateway.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html" },
            { id: 19, question: "A security team is investigating intermittent connection issues. They enabled VPC Flow Logs yesterday but the CloudWatch Logs log group was accidentally deleted this morning. What is the current state?", options: ["Flow Logs automatically created a new log group and continued logging", "The Flow Log entered an error state and stopped capturing traffic", "Flow Logs cached the data locally and will resume when the destination is restored", "The Flow Log switched to the default S3 bucket for the region"], correct: 1, explanation: "When the destination (CloudWatch Logs log group or S3 bucket) is deleted, the VPC Flow Log enters an error state and stops capturing traffic. You must delete the broken flow log and create a new one with a valid destination.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs-troubleshooting.html" },
            { id: 20, question: "A NACL needs to allow inbound HTTPS (443) from anywhere, but responses aren't working. The security team added outbound rule allowing 443 but responses still fail. What is the issue?", options: ["NACLs require matching Security Group rules to allow traffic", "Outbound responses use ephemeral ports (1024-65535), not port 443", "The NACL needs a specific rule for TCP ACK packets", "HTTPS requires both port 443 and port 80 to be allowed"], correct: 1, explanation: "NACLs are stateless. Inbound HTTPS comes on port 443, but the response goes out on an ephemeral port (typically 1024-65535). The outbound rule must allow the ephemeral port range, not just port 443. This is a common NACL configuration mistake.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#nacl-ephemeral-ports" },
            { id: 21, question: "A company accidentally deleted rule 32767 (the asterisk rule) from their Network ACL and now all traffic in the subnet is allowed. A junior engineer asks how this happened.", options: ["Rule 32767 is editable and the engineer must have changed it to 'allow all'", "The rule 32767 cannot be deleted - the engineer may be looking at a different NACL", "Deleting rule 32767 removes the default deny, so the implicit allow takes over", "Custom NACLs don't have rule 32767 - only the default NACL does"], correct: 1, explanation: "Rule 32767 (displayed as * in the console) is the immutable default deny rule that cannot be modified or deleted. If the engineer thinks they deleted it, they're either looking at a different NACL or misunderstanding what they changed.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#nacl-rules" },
            { id: 22, question: "An application uses dynamic ports and the Security Group has reached the 60 inbound rules limit. What is the recommended solution?", options: ["Request a service limit increase for Security Group rules", "Use multiple Security Groups attached to the same instance", "Replace granular rules with broader CIDR ranges or Security Group references", "Switch to Network ACLs which have no rule limits"], correct: 2, explanation: "While you can request limit increases or use multiple Security Groups, the best practice is to use Security Group references instead of individual IPs, or broader CIDR ranges. This reduces rule count and is more maintainable as resources change.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/amazon-vpc-limits.html" },
            { id: 23, question: "A security audit requires proof that all SSH attempts to production instances (successful or not) were logged for the past 90 days. VPC Flow Logs were configured to capture only ACCEPT traffic. What is the problem?", options: ["VPC Flow Logs cannot capture SSH-specific traffic patterns", "Rejected SSH attempts were not logged because only ACCEPT traffic was captured", "The 90-day retention period has expired for rejected traffic", "SSH uses encrypted traffic which VPC Flow Logs cannot inspect"], correct: 1, explanation: "VPC Flow Logs with traffic type filter 'ACCEPT' only capture allowed traffic. Rejected SSH attempts (blocked by Security Groups or NACLs) require 'REJECT' or 'ALL' filter to be logged. The audit requirement cannot be met with current configuration.", docLink: "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html#flow-logs-basics" },
            { id: 24, question: "A developer needs to connect an EC2 instance to AWS Systems Manager without internet access. Interface Endpoints cost money. Is there an alternative for SSM?", options: ["SSM Agent can use Gateway Endpoints like S3 for communication", "No, Systems Manager requires Interface Endpoints for private connectivity", "SSM can use VPC Peering to the AWS managed SSM VPC", "PrivateLink is included free for AWS management services like SSM"], correct: 1, explanation: "AWS Systems Manager requires Interface Endpoints (powered by PrivateLink) for private connectivity. Unlike S3 and DynamoDB which have free Gateway Endpoints, SSM needs Interface Endpoints in each AZ, which incur hourly and data processing charges.", docLink: "https://docs.aws.amazon.com/vpc/latest/privatelink/create-interface-endpoint.html" },
            { id: 25, question: "A company's security policy requires all S3 traffic from EC2 instances to stay within AWS's private network, even for S3 buckets in other regions. The current S3 Gateway Endpoint only works for same-region buckets. What should they do?", options: ["Create S3 Gateway Endpoints in each region where buckets exist", "Use S3 Interface Endpoint which supports cross-region bucket access over PrivateLink", "Configure S3 Cross-Region Replication to bring data to the local region", "Gateway Endpoints support cross-region access when properly configured in route tables"], correct: 1, explanation: "S3 Gateway Endpoints only work for same-region S3 access. For cross-region S3 access while staying on AWS's private network, you need S3 Interface Endpoints, which use PrivateLink and can route to S3 buckets in any region.", docLink: "https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-s3.html" }
        ];

        let currentMode = 'learn', currentQuestion = 0, userAnswers = [], answersRevealed = [], shuffledQuestions = [], timerInterval = null, timeRemaining = 0, inReviewMode = false, reviewedQuestions = [];
        function shuffleArray(a) { const b = [...a]; for (let i = b.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [b[i], b[j]] = [b[j], b[i]]; } return b; }
        function shuffleQuestionOptions(q) { const idx = shuffleArray([0,1,2,3]); return { ...q, options: idx.map(i => q.options[i]), correct: idx.indexOf(q.correct) }; }
        function startQuiz(mode) { currentMode = mode; currentQuestion = 0; userAnswers = new Array(questions.length).fill(null); answersRevealed = new Array(questions.length).fill(false); shuffledQuestions = shuffleArray(questions).map(shuffleQuestionOptions); inReviewMode = false; reviewedQuestions = []; document.getElementById('modeSelector').classList.add('hidden'); document.getElementById('quizContent').classList.remove('hidden'); document.getElementById('resultsCard').classList.remove('show'); document.getElementById('reviewSection').classList.remove('show'); document.getElementById('backToReviewBtn').style.display = 'none'; document.getElementById('totalQ').textContent = shuffledQuestions.length; if (mode === 'exam') { timeRemaining = shuffledQuestions.length * 150; startTimer(); document.getElementById('shuffleBtn').classList.add('hidden'); } else { document.getElementById('timer').textContent = 'Learn Mode'; document.getElementById('shuffleBtn').classList.remove('hidden'); } renderQuestion(); }
        function startTimer() { updateTimerDisplay(); timerInterval = setInterval(() => { timeRemaining--; updateTimerDisplay(); if (timeRemaining <= 0) { clearInterval(timerInterval); showResults(); } }, 1000); }
        function updateTimerDisplay() { const m = Math.floor(timeRemaining / 60), s = timeRemaining % 60, el = document.getElementById('timer'); el.textContent = `${m}:${s.toString().padStart(2, '0')}`; el.classList.remove('warning', 'danger'); if (timeRemaining <= 60) el.classList.add('danger'); else if (timeRemaining <= 300) el.classList.add('warning'); }
        function renderQuestion() { const q = shuffledQuestions[currentQuestion], container = document.getElementById('questionsContainer'), letters = ['A','B','C','D'], ans = userAnswers[currentQuestion], revealed = answersRevealed[currentQuestion]; let opts = q.options.map((o, i) => { let c = 'option'; if (currentMode === 'learn' && revealed) { c += ' disabled'; if (i === q.correct) c += ' correct'; else if (i === ans && ans !== q.correct) c += ' incorrect'; } else if (ans === i) c += ' selected'; return `<div class="${c}" onclick="selectOption(${i})"><span class="option-marker">${letters[i]}</span><span class="option-text">${o}</span></div>`; }).join(''); let exp = currentMode === 'learn' ? `<div class="explanation ${revealed ? 'show' : ''}"><div class="explanation-title">üìñ Explanation</div><div class="answer-header">Correct Answer: ${letters[q.correct]}</div><p class="explanation-text">${q.explanation}</p><a href="${q.docLink}" target="_blank" class="doc-link">üìÑ View AWS Documentation ‚Üí</a></div>` : ''; container.innerHTML = `<div class="question-card"><div class="question-header"><span class="question-number">Question ${currentQuestion + 1}</span><span class="question-domain">VPC Security</span></div><p class="question-text">${q.question}</p><div class="options">${opts}</div>${currentMode === 'learn' && !revealed ? '<button class="btn btn-primary" style="margin-top:1rem;width:100%;" onclick="revealAnswer()">Show Answer</button>' : ''}${exp}</div>`; document.getElementById('currentQ').textContent = currentQuestion + 1; document.getElementById('progressFill').style.width = `${((currentQuestion + 1) / shuffledQuestions.length) * 100}%`; document.getElementById('prevBtn').disabled = currentQuestion === 0; document.getElementById('nextBtn').textContent = currentQuestion === shuffledQuestions.length - 1 ? (currentMode === 'exam' ? 'Submit Quiz' : 'See Results') : 'Next ‚Üí'; }
        function selectOption(i) { if (currentMode === 'learn' && answersRevealed[currentQuestion]) return; userAnswers[currentQuestion] = i; renderQuestion(); }
        function revealAnswer() { if (userAnswers[currentQuestion] === null) userAnswers[currentQuestion] = -1; answersRevealed[currentQuestion] = true; renderQuestion(); }
        function navigate(dir) { if (dir === 1 && currentQuestion === shuffledQuestions.length - 1) { showResults(); return; } currentQuestion = Math.max(0, Math.min(currentQuestion + dir, shuffledQuestions.length - 1)); renderQuestion(); }
        function shuffleQuiz() { if (currentMode !== 'learn') return; currentQuestion = 0; userAnswers = new Array(questions.length).fill(null); answersRevealed = new Array(questions.length).fill(false); shuffledQuestions = shuffleArray(questions).map(shuffleQuestionOptions); renderQuestion(); }
        function showResults() { if (timerInterval) clearInterval(timerInterval); let c = 0; shuffledQuestions.forEach((q, i) => { if (userAnswers[i] !== null && userAnswers[i] !== -1 && userAnswers[i] === q.correct) c++; }); const t = shuffledQuestions.length, p = Math.round((c / t) * 100), pass = p >= 80; document.getElementById('quizContent').classList.add('hidden'); document.getElementById('reviewSection').classList.remove('show'); document.getElementById('resultsCard').classList.add('show'); document.getElementById('scorePercent').textContent = p + '%'; document.getElementById('scorePercent').className = 'results-score ' + (pass ? 'pass' : 'fail'); document.getElementById('resultStatus').textContent = pass ? 'üéâ PASSED!' : 'üìö Keep Studying'; document.getElementById('resultStatus').className = 'results-status ' + (pass ? 'pass' : 'fail'); document.getElementById('resultDetails').textContent = `You answered ${c} out of ${t} questions correctly. ${pass ? 'Great job!' : 'You need 80% to pass.'}`; document.getElementById('correctCount').textContent = c; document.getElementById('incorrectCount').textContent = t - c;  }
        function restartQuiz() { document.getElementById('resultsCard').classList.remove('show'); document.getElementById('reviewSection').classList.remove('show'); document.getElementById('backToReviewBtn').style.display = 'none'; document.getElementById('modeSelector').classList.remove('hidden'); document.getElementById('quizContent').classList.add('hidden'); inReviewMode = false; reviewedQuestions = []; if (timerInterval) clearInterval(timerInterval); }
        function showReview() { const letters = ['A','B','C','D'], tbody = document.getElementById('reviewTableBody'); tbody.innerHTML = ''; shuffledQuestions.forEach((q, idx) => { const userAns = userAnswers[idx] !== null && userAnswers[idx] !== undefined ? userAnswers[idx] : -1, isCorrect = userAns === q.correct, rowClass = reviewedQuestions.includes(idx) ? 'reviewed' : ''; let row = '<tr class="' + rowClass + '" onclick="reviewQuestion(' + idx + ')">'; row += '<td class="review-q-num">' + (idx + 1) + '</td>'; row += '<td class="review-q-text">' + q.question.substring(0, 100) + (q.question.length > 100 ? '...' : '') + '</td>'; row += '<td class="review-answer ' + (userAns >= 0 ? (isCorrect ? 'correct' : 'incorrect') : '') + '">' + (userAns >= 0 ? letters[userAns] : '‚Äî') + '</td>'; row += '<td class="review-answer correct">' + letters[q.correct] + '</td>'; row += '<td>' + (isCorrect ? '<span style="color:var(--success)">‚úì Correct</span>' : '<span style="color:var(--error)">‚úó Incorrect</span>') + '</td>'; row += '</tr>'; tbody.innerHTML += row; }); document.getElementById('totalReviewCount').textContent = shuffledQuestions.length; document.getElementById('reviewedCount').textContent = reviewedQuestions.length; document.getElementById('resultsCard').classList.remove('show'); document.getElementById('reviewSection').classList.add('show'); }
        function reviewQuestion(qIndex) { if (!reviewedQuestions.includes(qIndex)) { reviewedQuestions.push(qIndex); document.getElementById('reviewedCount').textContent = reviewedQuestions.length; } currentMode = 'learn'; currentQuestion = qIndex; answersRevealed[qIndex] = true; inReviewMode = true; document.getElementById('reviewSection').classList.remove('show'); document.getElementById('quizContent').classList.remove('hidden'); document.getElementById('timer').textContent = 'Learn Mode'; document.getElementById('shuffleBtn').style.display = 'none'; document.getElementById('backToReviewBtn').style.display = 'inline-block'; if (timerInterval) clearInterval(timerInterval); renderQuestion(); }
        function backToReview() { document.getElementById('quizContent').classList.add('hidden'); document.getElementById('backToReviewBtn').style.display = 'none'; document.getElementById('reviewSection').classList.add('show'); showReview(); }
        function backToResults() { document.getElementById('reviewSection').classList.remove('show'); document.getElementById('resultsCard').classList.add('show'); }
    </script>
</body>
</html>
